<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-02-01 Wed 13:36 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tapis</title>
<meta name="author" content="Chahak Mehta" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="../style.css" type="text/css"/>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">
<div id="updated">Updated: 2023-02-01 Wed 13:36</div>
<nav>
<a href="/tuitus/">Home</a>
<a href="/tuitus/files/sitemap.html">Posts</a>
</nav>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Tapis</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org321ecc1">1. <kbd>tapis-cli</kbd></a></li>
<li><a href="#org5bf7cbf">2. Setting up a neo4j pod</a></li>
<li><a href="#orgd92a202">3. Fetching file information using <kbd>tapipy</kbd></a></li>
<li><a href="#org5a0b413">4. Get model configurations for experiments</a></li>
<li><a href="#orgafbde02">5. Use <code>requests</code> module to retrieve files for projects</a>
<ul>
<li><a href="#orgd9ebc63">5.1. Get a list of projects</a></li>
<li><a href="#orgc3d4da4">5.2. Get files for a project</a></li>
<li><a href="#org385c9df">5.3. Download entire project info together</a></li>
</ul>
</li>
<li><a href="#org5b7e330">6. Generate summary and metadata info for the files</a></li>
<li><a href="#org702b80e">7. Store information in a neo4j database</a>
<ul>
<li><a href="#orgb327795">7.1. Connecting to a Neo4j database</a></li>
<li><a href="#org8fef419">7.2. Adding nodes</a></li>
</ul>
</li>
<li><a href="#orga551dce">8. Extract experiment and model config information from the project JSON</a></li>
</ul>
</div>
</nav>

<div id="outline-container-org321ecc1" class="outline-2">
<h2 id="org321ecc1"><span class="section-number-2">1.</span> <kbd>tapis-cli</kbd></h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<p>
Tapis CLI is a human-friendly, scriptable command line interface, implemented in Python, that helps scientists and engineers build and manage scalable computational and data science workflow projects using the <a href="https://tacc-cloud.readthedocs.io/projects/agave/en/latest/">Tapis</a> platform.
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-shell">tapis --version
</pre>
</div>

<pre class="example">
tapis 1.0.6
</pre>


<p>
To initialize a host, run <code>tapis auth init</code>
</p>

<div class="org-src-container">
<pre class="src src-shell">tapis auth init
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;Field&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;Value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;tenant_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;api_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;access_token&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;expires_at&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;verify&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;registry_url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;registry_username&nbsp;&nbsp;<br />
      &nbsp;registry_password&nbsp;&nbsp;<br />
      &nbsp;registry_namespace&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;designsafe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;chahak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Q***************************&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;f*******************************&nbsp;<br />
      &nbsp;Sat&nbsp;Jan&nbsp;&nbsp;7&nbsp;17:52:20&nbsp;2023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;True&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;https://index.docker.io&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;chahak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;a*********U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;chahak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<p>
To list the files present in my default folder, I simply use the <code>tapis files list</code> command with the default storage location.
</p>
<div class="org-src-container">
<pre class="src src-shell">tapis files list agave://designsafe.storage.default/chahak/
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;lastModified&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;length&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;test-datadepot.txt&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;4&nbsp;hours&nbsp;ago&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;
    </td>
  </tr>
</table>

<p>
In this call, the <kbd>designsafe.storage.default</kbd> is the <i>systemId</i> where the data is stored and <i>chahak</i> is my username (and here, the default path). Both these information can be gleaned from the URL on the browser. For example, if the url is
</p>

<blockquote>
<p>
<a href="https://www.designsafe-ci.org/data/browser/public/designsafe.storage.community/Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses/University_of_Washington/freeFieldEffectiveJupyter">https://www.designsafe-ci.org/data/browser/public/designsafe.storage.community/Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses/University_of_Washington/freeFieldEffectiveJupyter</a>
</p>
</blockquote>

<p>
then, <code>systemId=designsafe.storage.community</code> and <code>path=Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses</code>. Therefore, the call would begin
</p>

<div class="org-src-container">
<pre class="src src-shell">tapis files list agave://designsafe.storage.community/Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses/University_of_Washington/freeFieldEffectiveJupyter
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;lastModified&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;length&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;ShortReport.rst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;ShortReport.tex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;exampleDescription.pptx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;freeFieldEffective.tcl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;freeFieldEffectiveJupyter_community.ipynb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;freeFieldEffectiveJupyter_community_2022-07-25&nbsp;22-40-57.ipynb&nbsp;<br />
      &nbsp;macros.tex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotAcc.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotPorepressure.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotProfile.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotStressStrain.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;respSpectra.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;schematic.eps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;schematic.png&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;short.tex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;untitled.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;velocity.input&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;6&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;1380&nbsp;<br />
      &nbsp;&nbsp;&nbsp;1863&nbsp;<br />
      &nbsp;&nbsp;51605&nbsp;<br />
      &nbsp;&nbsp;17925&nbsp;<br />
      &nbsp;139950&nbsp;<br />
      &nbsp;140107&nbsp;<br />
      &nbsp;&nbsp;&nbsp;1954&nbsp;<br />
      &nbsp;&nbsp;&nbsp;1626&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;871&nbsp;<br />
      &nbsp;&nbsp;&nbsp;2791&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;620&nbsp;<br />
      &nbsp;&nbsp;&nbsp;2340&nbsp;<br />
      &nbsp;908760&nbsp;<br />
      &nbsp;&nbsp;&nbsp;5246&nbsp;<br />
      &nbsp;&nbsp;&nbsp;3346&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;<br />
      &nbsp;100260&nbsp;
    </td>
  </tr>
</table>

<p>
Similarly, if we want the information of a project, say <a href="https://www.designsafe-ci.org/data/browser/public/designsafe.storage.published/PRJ-3484">https://www.designsafe-ci.org/data/browser/public/designsafe.storage.published/PRJ-3484</a>,
</p>

<div class="org-src-container">
<pre class="src src-shell">tapis files list agave://designsafe.storage.published/PRJ-3484
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;lastModified&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;length&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;CDSS_ResultsPlot.m&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Direct&nbsp;Simple&nbsp;Shear&nbsp;Experimental&nbsp;Setup.pdf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Direct&nbsp;Simple&nbsp;Shear&nbsp;Test&nbsp;Sensors.pdf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Summary&nbsp;Report&nbsp;on&nbsp;Ottawa&nbsp;F65&nbsp;Sand&nbsp;CDSS&nbsp;Tests.pdf&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_160_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_210_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_240_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_250_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_300_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_150_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_200_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_230_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_180_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_200_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_210_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_220_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_250_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_150_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_200_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_250_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_300_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_150_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_200_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_200_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_210_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_220_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_220_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_220_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_230_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_230_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_240_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_250_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_250_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_250_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_270_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_270_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_300_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_300_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_320_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_350_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_100_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_120_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_140_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_150_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_180_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3780&nbsp;<br />
      &nbsp;&nbsp;&nbsp;333090&nbsp;<br />
      &nbsp;&nbsp;&nbsp;132480&nbsp;<br />
      &nbsp;11470561&nbsp;<br />
      &nbsp;&nbsp;&nbsp;367421&nbsp;<br />
      &nbsp;&nbsp;&nbsp;266759&nbsp;<br />
      &nbsp;&nbsp;&nbsp;133005&nbsp;<br />
      &nbsp;&nbsp;&nbsp;106531&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;73409&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;48243&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;20694&nbsp;<br />
      &nbsp;&nbsp;&nbsp;426255&nbsp;<br />
      &nbsp;&nbsp;&nbsp;145600&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;75184&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;57140&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;76043&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;39150&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;24488&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;29512&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;20205&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;19307&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;11603&nbsp;<br />
      &nbsp;&nbsp;1350936&nbsp;<br />
      &nbsp;&nbsp;&nbsp;740401&nbsp;<br />
      &nbsp;&nbsp;&nbsp;111957&nbsp;<br />
      &nbsp;&nbsp;&nbsp;194061&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;50388&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;65815&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;22568&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;41252&nbsp;<br />
      &nbsp;&nbsp;&nbsp;253281&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;95541&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;62701&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;51772&nbsp;<br />
      &nbsp;&nbsp;&nbsp;956617&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;45227&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;28760&nbsp;<br />
      &nbsp;&nbsp;&nbsp;428522&nbsp;<br />
      &nbsp;&nbsp;2254872&nbsp;<br />
      &nbsp;&nbsp;&nbsp;351036&nbsp;<br />
      &nbsp;&nbsp;1757060&nbsp;<br />
      &nbsp;&nbsp;&nbsp;282245&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;12117&nbsp;<br />
      &nbsp;&nbsp;&nbsp;204689&nbsp;<br />
      &nbsp;&nbsp;&nbsp;661142&nbsp;<br />
      &nbsp;&nbsp;&nbsp;196049&nbsp;<br />
      &nbsp;&nbsp;&nbsp;688310&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;40408&nbsp;<br />
      &nbsp;&nbsp;&nbsp;447705&nbsp;<br />
      &nbsp;&nbsp;&nbsp;447356&nbsp;<br />
      &nbsp;&nbsp;&nbsp;128002&nbsp;<br />
      &nbsp;&nbsp;&nbsp;819420&nbsp;<br />
      &nbsp;&nbsp;&nbsp;219298&nbsp;<br />
      &nbsp;&nbsp;&nbsp;138572&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;91315&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;54473&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;58544&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;48529&nbsp;
    </td>
  </tr>
</table>
</div>
</div>

<div id="outline-container-org5bf7cbf" class="outline-2">
<h2 id="org5bf7cbf"><span class="section-number-2">2.</span> Setting up a neo4j pod</h2>
<div class="outline-text-2" id="text-2">
<p>
Ref: <a href="https://tapis.readthedocs.io/en/latest/technical/pods.html">https://tapis.readthedocs.io/en/latest/technical/pods.html</a>
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Create TACC Account
<ul class="org-ul">
<li>Username: <kbd>chahak</kbd></li>
</ul></li>
<li class="on"><code>[X]</code> Create Docker
<ul class="org-ul">
<li>Username: <kbd>chahak</kbd></li>
</ul></li>
<li class="on"><code>[X]</code> <p>
Install Tapis Python SDK
</p>
<div class="org-src-container">
<pre class="src src-shell">pipenv install tapipy
</pre>
</div></li>
<li class="on"><code>[X]</code> TACC OAuth
<ul class="org-ul">
<li class="on"><code>[X]</code> <p>
Create Tapis Client Object
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> os
<span style="color: #89DDFF;">from</span> tapipy.tapis <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Tapis</span>

<span style="color: #ffcb6b;">t</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Tapis</span>(<span style="color: #89DDFF; font-weight: bold;">base_url</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"https://icicle.tapis.io"</span>,
          <span style="color: #89DDFF; font-weight: bold;">username</span><span style="color: #89DDFF;">=</span>os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">getenv</span>(<span style="color: #c3e88d;">"TACC_USERNAME"</span>),
          <span style="color: #89DDFF; font-weight: bold;">password</span><span style="color: #89DDFF;">=</span>os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">getenv</span>(<span style="color: #c3e88d;">"TACC_PASSWORD"</span>))

t.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get_tokens</span>()
t.<span style="color: #f78c6c; font-style: italic;">access_token</span>.<span style="color: #f78c6c; font-style: italic;">access_token</span>
</pre>
</div>

<pre class="example">
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9...
</pre></li>

<li class="on"><code>[X]</code> <p>
Check Access to the Tapis API
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #f78c6c; font-style: italic;">authenticator</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get_profile</span>(<span style="color: #89DDFF; font-weight: bold;">username</span><span style="color: #89DDFF;">=</span>os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">getenv</span>(<span style="color: #c3e88d;">"TACC_USERNAME"</span>))
</pre>
</div>

<pre class="example">

create_time: None
dn: cn=chahak,ou=People,dc=tacc,dc=utexas,dc=edu
email: chahak@utexas.edu
given_name: Chahak
last_name: Mehta
mobile_phone: None
phone: None
uid: 875122
username: chahak
</pre></li>
</ul></li>

<li class="on"><code>[X]</code> <p>
Registering a templated Pod
To register a pod, we use the <code>pods.create_pod()</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #f78c6c; font-style: italic;">pods</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create_pod</span>(<span style="color: #89DDFF; font-weight: bold;">pod_id</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"tuitustestpod"</span>, <span style="color: #89DDFF; font-weight: bold;">pod_template</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"neo4j"</span>, <span style="color: #89DDFF; font-weight: bold;">description</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"Creating test pod"</span>)
</pre>
</div>

<pre class="example" id="org39cead8">

  command: None
  creation_ts: 2023-01-06T15:34:20.551402
  data_attached: []
  data_requests: []
  description: Creating test pod
  environment_variables:

  networking:
  default:
  port: 7687
  protocol: tcp
  url: tuitustestpod.pods.icicle.tapis.io
  persistent_volume:

  pod_id: tuitustestpod
  pod_template: neo4j
  resources:
  cpu_limit: 2000
  cpu_request: 250
  mem_limit: 3072
  mem_request: 256
  roles_inherited: []
  roles_required: []
  start_instance_ts: None
  status: REQUESTED
  status_container:

  status_requested: ON
  time_to_stop_default: 43200
  time_to_stop_instance: None
  time_to_stop_ts: None
  update_ts: 2023-01-06T15:34:20.551422
</pre></li>
</ul>


<p>
The details and status of this <kbd>REQUESTED</kbd> pod can be accessed using the <code>get_pod()</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #f78c6c; font-style: italic;">pods</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get_pod</span>(<span style="color: #89DDFF; font-weight: bold;">pod_id</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"tuitustestpod"</span>)
</pre>
</div>

<pre class="example" id="org42b1a23">

command: None
creation_ts: 2023-01-06T15:34:20.551402
data_attached: []
data_requests: []
description: Creating test pod
environment_variables:

networking:
default:
port: 7687
protocol: tcp
url: tuitustestpod.pods.icicle.tapis.io
persistent_volume:

pod_id: tuitustestpod
pod_template: neo4j
resources:
cpu_limit: 2000
cpu_request: 250
mem_limit: 3072
mem_request: 256
roles_inherited: []
roles_required: []
start_instance_ts: 2023-01-06T16:06:34.268462
status: RUNNING
status_container:
message: Pod is running.
phase: Running
start_time: 2023-01-06T16:06:17.000000
status_requested: ON
time_to_stop_default: 43200
time_to_stop_instance: None
time_to_stop_ts: 2023-01-07T04:06:34.270380
update_ts: 2023-01-06T15:34:20.551422
</pre>

<p>
The logs can be retrieved using the <code>get_pod_logs()</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #f78c6c; font-style: italic;">pods</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get_pod_logs</span>(<span style="color: #89DDFF; font-weight: bold;">pod_id</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"tuitustestpod"</span>)
</pre>
</div>

<pre class="example" id="orge08ca42">

logs: 2023-01-06 16:06:39.132+0000 INFO  Starting...
2023-01-06 16:06:40.347+0000 INFO  This instance is ServerId{e6102ec8} (e6102ec8-c9a0-4650-b0df-b523b7475f5a)
2023-01-06 16:06:42.487+0000 INFO  ======== Neo4j 4.4.16 ========
2023-01-06 16:06:48.846+0000 INFO  [system/00000000] successfully initialized: CREATE USER podsservice IF NOT EXISTS SET PLAINTEXT PASSWORD 'servicepass' SET PASSWORD CHANGE NOT REQUIRED
2023-01-06 16:06:49.145+0000 INFO  [system/00000000] successfully initialized: CREATE USER tuitustestpod IF NOT EXISTS SET PLAINTEXT PASSWORD 'userpass' SET PASSWORD CHANGE NOT REQUIRED
2023-01-06 16:06:56.019+0000 INFO  Upgrading security graph to latest version
2023-01-06 16:06:56.020+0000 INFO  Setting version for 'security-users' to 2
2023-01-06 16:06:56.022+0000 INFO  Upgrading 'security-users' version property from 2 to 3
2023-01-06 16:06:56.283+0000 INFO  Called db.clearQueryCaches(): Query cache already empty.
2023-01-06 16:06:56.439+0000 INFO  Bolt enabled on [0:0:0:0:0:0:0:0%0]:7687.
2023-01-06 16:06:57.632+0000 INFO  Remote interface available at http://pods-tacc-icicle-tuitustestpod:7474/
2023-01-06 16:06:57.637+0000 INFO  id: 8ACF4A544C1C241897F7E92DEED8D4D2266674C622192A7F52378EF69EA3644A
2023-01-06 16:06:57.637+0000 INFO  name: system
2023-01-06 16:06:57.637+0000 INFO  creationDate: 2023-01-06T16:06:43.669Z
2023-01-06 16:06:57.637+0000 INFO  Started.
</pre>

<p>
List of all pods - <code>get_pods()</code>
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #82aaff; font-weight: bold;">print</span>(t.<span style="color: #f78c6c; font-style: italic;">pods</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get_pods</span>())
</pre>
</div>

<pre class="example" id="orgce8cad4">
[
command: None
creation_ts: 2023-01-06T15:34:20.551402
data_attached: []
data_requests: []
description: Creating test pod
environment_variables: 

networking: 
default: 
port: 7687
protocol: tcp
url: tuitustestpod.pods.icicle.tapis.io
persistent_volume: 

pod_id: tuitustestpod
pod_template: neo4j
resources: 
cpu_limit: 2000
cpu_request: 250
mem_limit: 3072
mem_request: 256
roles_inherited: []
roles_required: []
start_instance_ts: 2023-01-06T16:06:34.268462
status: RUNNING
status_container: 
message: Pod is running.
phase: Running
start_time: 2023-01-06T16:06:17.000000
status_requested: ON
time_to_stop_default: 43200
time_to_stop_instance: None
time_to_stop_ts: 2023-01-07T04:06:34.270380
update_ts: 2023-01-06T15:34:20.551422]
</pre>


<p>
Any pod can be deleted using the <code>delete_pod(pod_id)</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #f78c6c; font-style: italic;">pods</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">delete_pod</span>(<span style="color: #89DDFF; font-weight: bold;">pod_id</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"tuitustestpod"</span>)
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">message</td>
<td class="org-left">:</td>
<td class="org-left">Pod successfully deleted.</td>
<td class="org-left">metadata</td>
<td class="org-left">:</td>
<td class="org-left">nil</td>
<td class="org-left">result</td>
<td class="org-left">:</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">status</td>
<td class="org-left">:</td>
<td class="org-left">success</td>
<td class="org-left">version</td>
<td class="org-left">:</td>
<td class="org-left">dev</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgd92a202" class="outline-2">
<h2 id="orgd92a202"><span class="section-number-2">3.</span> Fetching file information using <kbd>tapipy</kbd></h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><p>
Create <code>Tapis</code> object and generate a token.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> os
<span style="color: #89DDFF;">from</span> tapipy.tapis <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Tapis</span>

<span style="color: #ffcb6b;">t</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Tapis</span>(<span style="color: #89DDFF; font-weight: bold;">base_url</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"https://designsafe.tapis.io"</span>,
          <span style="color: #89DDFF; font-weight: bold;">username</span><span style="color: #89DDFF;">=</span>os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">getenv</span>(<span style="color: #c3e88d;">"TACC_USERNAME"</span>),
          <span style="color: #89DDFF; font-weight: bold;">password</span><span style="color: #89DDFF;">=</span>os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">getenv</span>(<span style="color: #c3e88d;">"TACC_PASSWORD"</span>))
t.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get_tokens</span>()
<span style="color: #556369;"># t.access_token</span>
</pre>
</div>

<p>
Using the <code>systemId</code> as <kbd>designsafe.storage.default</kbd>, fetch files.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #f78c6c; font-style: italic;">files</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">listFiles</span>(<span style="color: #89DDFF; font-weight: bold;">systemId</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"designsafe.storage.default"</span>, <span style="color: #89DDFF; font-weight: bold;">path</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"chahak"</span>)
</pre>
</div>

<pre class="example" id="org99e07b1">
  ---------------------------------------------------------------------------
  NotFoundError                             Traceback (most recent call last)
  Cell In[6], line 1
  ----&gt; 1 t.files.listFiles(systemId="designsafe.storage.default", path="chahak")

  File ~/.local/share/virtualenvs/tuitus-75BIUZJs/lib/python3.9/site-packages/tapipy/tapis.py:1191, in Operation.__call__(self, **kwargs)
     1189     raise errors.ForbiddenError(msg=error_msg, version=version, request=r, response=resp)
     1190 if resp.status_code == 404:
  -&gt; 1191     raise errors.NotFoundError(msg=error_msg, version=version, request=r, response=resp)
     1192 if resp.status_code == 503:
     1193     raise errors.ServiceUnavailableError(msg=error_msg, version=version, request=r, response=resp)

  NotFoundError: message: SYSAPI_NOT_FOUND Record not found. jwtTenant: admin jwtUser: files OboTenant: designsafe OboUser: chahak System: designsafe.storage.default
</pre>

<p>
Seems like tapipy is using v3 apis which doesn&rsquo;t seem to have any systems that it retrieves via <code>getSystems()</code> on <kbd>designsafe</kbd>. Not sure if I can work with this right now.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org5a0b413" class="outline-2">
<h2 id="org5a0b413"><span class="section-number-2">4.</span> Get model configurations for experiments</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>I&rsquo;m trying to find a way to get information about the model configurations and experiment setup on this page. I found using inspect element that there is an API call to <a href="https://www.designsafe-ci.org/api/projects/publication/PRJ-3484/">https://www.designsafe-ci.org/api/projects/publication/PRJ-3484/</a> and that has a field for <kbd>modelConfigs</kbd> that has experiments but it has <kbd>associationIds</kbd> which are UUIDs if I&rsquo;m not wrong, and the above API is the only way I could find to resolve UUIDs but it doesn&rsquo;t seem to be working.</li>
<li>According to Dr. Krishna, UUID lookup is not available in designsafe yet so letting this be for now.</li>
</ul>
</div>
</div>
<div id="outline-container-orgafbde02" class="outline-2">
<h2 id="orgafbde02"><span class="section-number-2">5.</span> Use <code>requests</code> module to retrieve files for projects</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>Even without model configs for experiments, next thing to do is to get all the files for all the projects.</li>
</ul>
</div>
<div id="outline-container-orgd9ebc63" class="outline-3">
<h3 id="orgd9ebc63"><span class="section-number-3">5.1.</span> Get a list of projects</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Using the <code>requests</code> module, we can create a request to <kbd>https://designsafe-ci.org/api/publications/listing</kbd> to get a list of the projects.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">from</span> pprint <span style="color: #89DDFF;">import</span> pprint
<span style="color: #89DDFF;">import</span> requests

<span style="color: #ffcb6b;">url</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">"https://designsafe-ci.org/api/publications/listing"</span>

<span style="color: #ffcb6b;">querystring</span> <span style="color: #89DDFF;">=</span> {<span style="color: #c3e88d;">"limit"</span>:<span style="color: #c3e88d;">"3"</span>}

<span style="color: #ffcb6b;">payload</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">""</span>
<span style="color: #ffcb6b;">headers</span> <span style="color: #89DDFF;">=</span> {
    <span style="color: #556369;"># "cookie": "django_language=en-us",</span>
    <span style="color: #556369;"># "Host": "www.designsafe-ci.org",</span>
    <span style="color: #c3e88d;">"User-Agent"</span>: <span style="color: #c3e88d;">"Mozilla/5.0 (X11; Linux x86_64; rv:108.0) Gecko/20100101 Firefox/108.0"</span>,
    <span style="color: #c3e88d;">"Accept"</span>: <span style="color: #c3e88d;">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>,
    <span style="color: #c3e88d;">"Accept-Language"</span>: <span style="color: #c3e88d;">"en-US,en;q=0.5"</span>,
    <span style="color: #c3e88d;">"Accept-Encoding"</span>: <span style="color: #c3e88d;">"gzip, deflate, br"</span>,
    <span style="color: #c3e88d;">"DNT"</span>: <span style="color: #c3e88d;">"1"</span>,
    <span style="color: #c3e88d;">"Connection"</span>: <span style="color: #c3e88d;">"keep-alive"</span>,
    <span style="color: #c3e88d;">"Upgrade-Insecure-Requests"</span>: <span style="color: #c3e88d;">"1"</span>,
    <span style="color: #c3e88d;">"Sec-Fetch-Dest"</span>: <span style="color: #c3e88d;">"document"</span>,
    <span style="color: #c3e88d;">"Sec-Fetch-Mode"</span>: <span style="color: #c3e88d;">"navigate"</span>,
    <span style="color: #c3e88d;">"Sec-Fetch-Site"</span>: <span style="color: #c3e88d;">"none"</span>,
    <span style="color: #c3e88d;">"Sec-Fetch-User"</span>: <span style="color: #c3e88d;">"?1"</span>,
    <span style="color: #c3e88d;">"TE"</span>: <span style="color: #c3e88d;">"trailers"</span>
}

<span style="color: #ffcb6b;">response</span> <span style="color: #89DDFF;">=</span> requests.<span style="color: #c792ea; font-weight: bold; font-style: italic;">request</span>(<span style="color: #c3e88d;">"GET"</span>, url, <span style="color: #89DDFF; font-weight: bold;">data</span><span style="color: #89DDFF;">=</span>payload, <span style="color: #89DDFF; font-weight: bold;">headers</span><span style="color: #89DDFF;">=</span>headers, <span style="color: #89DDFF; font-weight: bold;">params</span><span style="color: #89DDFF;">=</span>querystring)

<span style="color: #c792ea; font-weight: bold;">pprint</span>(response.<span style="color: #c792ea; font-weight: bold; font-style: italic;">json</span>())
</pre>
</div>

<pre class="example" id="org236fc0a">
{'listing': [{'created': '2023-01-09T21:13:07.982682',
              'pi': 'Zhang, Wenyang',
              'project': {'value': {'keywords': 'Physics-based ground motion '
                                                'simulation, loss and '
                                                'resilience assessments, '
                                                'regional analysis, Hercules, '
                                                'SimCenter R2D',
                                    'pi': 'wz_tacc',
                                    'projectType': 'simulation',
                                    'title': 'Regional-scale physics-based '
                                             'ground motion simulation for '
                                             'Istanbul, Turkey'}},
              'projectId': 'PRJ-3712'},
             {'created': '2023-01-09T18:06:55.086860',
              'pi': 'Akin, Idil Deniz',
              'project': {'value': {'keywords': 'suction, water content, '
                                                'post-wildfire',
                                    'pi': 'idil',
                                    'projectType': 'field_recon',
                                    'title': '2019 Williams Flats Wildfire '
                                             'Slope Stability'}},
              'projectId': 'PRJ-3685'},
             {'created': '2023-01-09T01:52:04.001722',
              'pi': 'Matta, Fabio',
              'project': {'value': {'keywords': 'Compressive strength, earth '
                                                'masonry, isotropy, '
                                                'homogeneity, statistical '
                                                'analysis',
                                    'pi': 'fmatta',
                                    'projectType': 'experimental',
                                    'title': 'Physico-Mechanical '
                                             'Characterization of Homogeneity '
                                             'and Isotropy of Prototype Earth '
                                             'Block Material'}},
              'projectId': 'PRJ-2809'}]}
</pre>
</div>
</div>


<div id="outline-container-orgc3d4da4" class="outline-3">
<h3 id="orgc3d4da4"><span class="section-number-3">5.2.</span> Get files for a project</h3>
<div class="outline-text-3" id="text-5-2">
<p>
For a given <kbd>projectId</kbd>, we need to get all the result files. The information for projects can be fetched from <kbd>https://designsafe-ci.org/api/projects/publication/{projectId}</kbd>. For example,
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">projectId</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">"PRJ-3484"</span>
<span style="color: #ffcb6b;">url</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">f"https://designsafe-ci.org/api/projects/publication/</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">projectId</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">"</span>

<span style="color: #ffcb6b;">payload</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">""</span>
<span style="color: #ffcb6b;">headers</span> <span style="color: #89DDFF;">=</span> {<span style="color: #c3e88d;">"cookie"</span>: <span style="color: #c3e88d;">"django_language=en-us"</span>}

<span style="color: #ffcb6b;">response</span> <span style="color: #89DDFF;">=</span> requests.<span style="color: #c792ea; font-weight: bold; font-style: italic;">request</span>(<span style="color: #c3e88d;">"GET"</span>, url, <span style="color: #89DDFF; font-weight: bold;">data</span><span style="color: #89DDFF;">=</span>payload, <span style="color: #89DDFF; font-weight: bold;">headers</span><span style="color: #89DDFF;">=</span>headers)
<span style="color: #ffcb6b;">response_json</span> <span style="color: #89DDFF;">=</span> response.<span style="color: #c792ea; font-weight: bold; font-style: italic;">json</span>()
</pre>
</div>

<ul class="org-ul">
<li>The response is a humongous \(\sym\) 1300 lines json object which contains basically all the information about the project that is present on the website. The fields of major importance right now would be <code>["eventsList"]</code>. This corresponds to the different experiment setups.</li>
<li>For every element in <code>"eventsList"</code>, <code>"fileObjs"</code> is the list of files for that experiment, <code>["value"]["title"]</code> is the title string of the experiment.</li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">files_info</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">dict</span>()
<span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">i</span>, <span style="color: #ffcb6b;">event</span> <span style="color: #89DDFF;">in</span> <span style="color: #82aaff; font-weight: bold;">enumerate</span>(response_json[<span style="color: #c3e88d;">"eventsList"</span>]):
    files_info[<span style="color: #ffcb6b;">i</span>] <span style="color: #89DDFF;">=</span> {
        <span style="color: #c3e88d;">"title"</span>: event[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"title"</span>],
        <span style="color: #c3e88d;">"files"</span>: event[<span style="color: #c3e88d;">"fileObjs"</span>]
        }
<span style="color: #c792ea; font-weight: bold;">pprint</span>(files_info[<span style="color: #f78c6c;">0</span>])
</pre>
</div>

<pre class="example" id="orgae760d6">
{'files': [{'name': 'eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'},
           {'name': 'eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'},
           {'name': 'eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'},
           {'name': 'eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'}],
 'title': 'CDSS tests with Sig_v = 100 kPa, Dr = 67%, Alpha = 0.4'}
</pre>

<p>
Now, to download any of those file, I can either create a request manually or use <code>tapis cli</code> to download it.
</p>

<div class="org-src-container">
<pre class="src src-bash">tapis files download agave://designsafe.storage.published/PRJ-3484/eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv
</pre>
</div>

<p>
<code>tapis cli</code> doesn&rsquo;t seem to allow specifying an output directory to save the file to, which is definitely not great as I&rsquo;ll have to either move them myself or change directory every time before saving the file. On the other hand, it has some support for multi-threaded downloads. Need more investigation on this.
</p>

<p>
On the other hand, <code>tapis cli</code> uses <code>agavepy</code> to download the files. So, for now, I could potentially use that directly to download these files.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">from</span> agavepy <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Agave</span>
<span style="color: #ffcb6b;">ag</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea;">Agave</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">restore</span>()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">rsp</span> <span style="color: #89DDFF;">=</span> ag.<span style="color: #f78c6c; font-style: italic;">files</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">download</span>(<span style="color: #89DDFF; font-weight: bold;">systemId</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"designsafe.storage.published"</span>, <span style="color: #89DDFF; font-weight: bold;">filePath</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"PRJ-3484/eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv"</span>)
<span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">isinstance</span>(rsp, dict):
    <span style="color: #89DDFF;">raise</span> <span style="color: #c792ea; font-weight: bold;">Error</span>(<span style="color: #c3e88d;">f"Failed to download"</span>)
<span style="color: #89DDFF;">with</span> <span style="color: #82aaff; font-weight: bold;">open</span>(<span style="color: #c3e88d;">'test.csv'</span>, <span style="color: #c3e88d;">'wb'</span>) <span style="color: #89DDFF;">as</span> dest_file:
    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">block</span> <span style="color: #89DDFF;">in</span> rsp.<span style="color: #c792ea; font-weight: bold; font-style: italic;">iter_content</span>(<span style="color: #f78c6c;">4096</span>):
        <span style="color: #89DDFF;">if</span> <span style="color: #89DDFF;">not</span> block:
            <span style="color: #89DDFF;">break</span>
        dest_file.<span style="color: #c792ea; font-weight: bold; font-style: italic;">write</span>(block)

<span style="color: #82aaff; font-weight: bold;">print</span>(os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">isfile</span>(<span style="color: #c3e88d;">'test.csv'</span>))
</pre>
</div>

<pre class="example">
True
</pre>


<p>
This tests works. So, I can create a function to do this and create a folder structure with files based on the experiment titles.
</p>
</div>
</div>

<div id="outline-container-org385c9df" class="outline-3">
<h3 id="org385c9df"><span class="section-number-3">5.3.</span> Download entire project info together</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Now it is time to combine all of the above together to get all the files of a project in a single go.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> os
<span style="color: #89DDFF;">import</span> requests
<span style="color: #89DDFF;">from</span> tqdm <span style="color: #89DDFF;">import</span> tqdm
<span style="color: #89DDFF;">from</span> agavepy <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Agave</span>
<span style="color: #ffcb6b;">ag</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea;">Agave</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">restore</span>()


<span style="color: #89DDFF;">def</span> <span style="color: #82aaff;">download_file</span>(<span style="color: #ffcb6b;">filepath</span>, <span style="color: #ffcb6b;">dirpath</span>):
    <span style="color: #ffcb6b;">rsp</span> <span style="color: #89DDFF;">=</span> ag.<span style="color: #f78c6c; font-style: italic;">files</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">download</span>(<span style="color: #89DDFF; font-weight: bold;">systemId</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"designsafe.storage.published"</span>,
                            <span style="color: #89DDFF; font-weight: bold;">filePath</span><span style="color: #89DDFF;">=</span>filepath)
    <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">isinstance</span>(rsp, dict):
        <span style="color: #89DDFF;">raise</span> <span style="color: #c792ea; font-weight: bold;">Error</span>(<span style="color: #c3e88d;">f"Failed to download: </span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">filepath</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">"</span>)
    <span style="color: #89DDFF;">if</span> <span style="color: #89DDFF;">not</span> os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">isdir</span>(dirpath):
        os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">makedirs</span>(dirpath)
    <span style="color: #89DDFF;">with</span> <span style="color: #82aaff; font-weight: bold;">open</span>(os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">join</span>(dirpath, os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">basename</span>(filepath)), <span style="color: #c3e88d;">"wb"</span>) <span style="color: #89DDFF;">as</span> f:
        <span style="color: #89DDFF;">try</span>:
            <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">block</span> <span style="color: #89DDFF;">in</span> rsp.<span style="color: #c792ea; font-weight: bold; font-style: italic;">iter_content</span>(<span style="color: #f78c6c;">4096</span>):
                <span style="color: #89DDFF;">if</span> <span style="color: #89DDFF;">not</span> block:
                    <span style="color: #89DDFF;">break</span>
                f.<span style="color: #c792ea; font-weight: bold; font-style: italic;">write</span>(block)
        <span style="color: #89DDFF;">except</span> <span style="color: #c792ea;">Exception</span> <span style="color: #89DDFF;">as</span> e:
            <span style="color: #89DDFF;">raise</span> e
    <span style="color: #89DDFF;">return</span> <span style="color: #82aaff;">True</span>


<span style="color: #89DDFF;">def</span> <span style="color: #82aaff;">download_project</span>(<span style="color: #ffcb6b;">projectId</span>):
    <span style="color: #ffcb6b;">url</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">f"https://designsafe-ci.org/api/projects/publication/</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">projectId</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">"</span>

    <span style="color: #ffcb6b;">payload</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">""</span>
    <span style="color: #ffcb6b;">headers</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">""</span>

    <span style="color: #ffcb6b;">response</span> <span style="color: #89DDFF;">=</span> requests.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get</span>(url, <span style="color: #89DDFF; font-weight: bold;">data</span><span style="color: #89DDFF;">=</span>payload, <span style="color: #89DDFF; font-weight: bold;">headers</span><span style="color: #89DDFF;">=</span>headers)
    <span style="color: #ffcb6b;">response_json</span> <span style="color: #89DDFF;">=</span> response.<span style="color: #c792ea; font-weight: bold; font-style: italic;">json</span>()

    <span style="color: #ffcb6b;">files_info</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">dict</span>()
    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">i</span>, <span style="color: #ffcb6b;">event</span> <span style="color: #89DDFF;">in</span> <span style="color: #82aaff; font-weight: bold;">enumerate</span>(response_json[<span style="color: #c3e88d;">"eventsList"</span>]):
        files_info[<span style="color: #ffcb6b;">i</span>] <span style="color: #89DDFF;">=</span> {
            <span style="color: #c3e88d;">"title"</span>: event[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"title"</span>],
            <span style="color: #c3e88d;">"files"</span>: event[<span style="color: #c3e88d;">"fileObjs"</span>],
        }

    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">event</span>, <span style="color: #ffcb6b;">data</span> <span style="color: #89DDFF;">in</span> <span style="color: #c792ea; font-weight: bold;">tqdm</span>(files_info.<span style="color: #c792ea; font-weight: bold; font-style: italic;">items</span>()):
        <span style="color: #ffcb6b;">dirpath</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">f"</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">projectId</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">/</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">data[</span><span style="color: #c3e88d; background-color: #263238;">'</span><span style="color: #EEFFFF; background-color: #263238;">title</span><span style="color: #c3e88d; background-color: #263238;">'</span><span style="color: #EEFFFF; background-color: #263238;">]</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">"</span>
        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">file</span> <span style="color: #89DDFF;">in</span> <span style="color: #c792ea; font-weight: bold;">tqdm</span>(data[<span style="color: #c3e88d;">"files"</span>], <span style="color: #89DDFF; font-weight: bold;">leave</span><span style="color: #89DDFF;">=</span><span style="color: #82aaff;">False</span>):
            <span style="color: #ffcb6b;">filepath</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">f"</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">projectId</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">/</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">file[</span><span style="color: #c3e88d; background-color: #263238;">'</span><span style="color: #EEFFFF; background-color: #263238;">path</span><span style="color: #c3e88d; background-color: #263238;">'</span><span style="color: #EEFFFF; background-color: #263238;">]</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">"</span>
            <span style="color: #c792ea; font-weight: bold;">download_file</span>(filepath, dirpath)

    <span style="color: #89DDFF;">return</span>


<span style="color: #ffcb6b;">projectId</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">"PRJ-3484"</span>
<span style="color: #c792ea; font-weight: bold;">download_project</span>(projectId)
</pre>
</div>

<p>
This downloads the project files and stores the files in the following structure.
</p>

<div class="org-src-container">
<pre class="src src-bash">tree PRJ-3484
</pre>
</div>

<pre class="example" id="orgb0601e1">
PRJ-3484
├── CDSS tests with Sig_v = 100 kPa, Dr = 66.7%, Alpha = 0
│   ├── eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_180_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_190_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_200_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_210_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_220_Tau_0_.csv
│   └── eo_0_600_sigv_100_CSR_0_250_Tau_0_.csv
├── CDSS tests with Sig_v = 100 kPa, Dr = 67%, Alpha = 0.3
│   ├── eo_0_601_sigv_100_CSR_0_150_Tau_30_.csv
│   ├── eo_0_601_sigv_100_CSR_0_200_Tau_30_.csv
│   ├── eo_0_601_sigv_100_CSR_0_250_Tau_30_.csv
│   └── eo_0_601_sigv_100_CSR_0_300_Tau_30_.csv
├── CDSS tests with Sig_v = 100 kPa, Dr = 67%, Alpha = 0.4
│   ├── eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv
│   ├── eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv
│   ├── eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv
│   └── eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 55.2%, Alpha = 0
│   ├── eo_0_631_sigv_40_CSR_0_100_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_120_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_140_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_150_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_170_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_180_Tau_0_.csv
│   └── eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 66.2%, Alpha = 0
│   ├── eo_0_601_sigv_40_CSR_0_150_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_170_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_190_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_200_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_210_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_220_Tau_0_.csv
│   └── eo_0_601_sigv_40_CSR_0_250_Tau_0_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 66.4%, Alpha = 0.25
│   ├── eo_0_601_sigv_40_CSR_0_200_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_220_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_230_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_240_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_250_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_270_Tau_10_.csv
│   └── eo_0_601_sigv_40_CSR_0_300_Tau_10_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 66.4%, Alpha = 0.375
│   ├── eo_0_601_sigv_40_CSR_0_220_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_230_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_250_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_270_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_300_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_320_Tau_15_.csv
│   └── eo_0_601_sigv_40_CSR_0_350_Tau_15_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 71.2%, Alpha = 0
│   ├── eo_0_588_sigv_40_CSR_0_150_Tau_0_.csv
│   ├── eo_0_588_sigv_40_CSR_0_170_Tau_0_.csv
│   ├── eo_0_588_sigv_40_CSR_0_200_Tau_0_.csv
│   └── eo_0_588_sigv_40_CSR_0_230_Tau_0_.csv
└── CDSS tests with Sig_v = 40 kPa, Dr = 75.5%, Alpha = 0
    ├── eo_0_576_sigv_40_CSR_0_160_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_170_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_190_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_210_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_240_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_250_Tau_0_.csv
    └── eo_0_576_sigv_40_CSR_0_300_Tau_0_.csv

10 directories, 54 files
</pre>
</div>
</div>
</div>
<div id="outline-container-org5b7e330" class="outline-2">
<h2 id="org5b7e330"><span class="section-number-2">6.</span> Generate summary and metadata info for the files</h2>
<div class="outline-text-2" id="text-6">
<p>
Next step in building a semantic search engine would be to generate the metadata info/summary for the files inside any project. This can be done using the <kbd>pandas</kbd> library.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> os
<span style="color: #89DDFF;">import</span> pandas <span style="color: #89DDFF;">as</span> pd
<span style="color: #89DDFF;">from</span> pprint <span style="color: #89DDFF;">import</span> pprint

<span style="color: #89DDFF;">def</span> <span style="color: #82aaff;">summarize_csv</span>(<span style="color: #ffcb6b;">filepath</span>):
    <span style="color: #c3e88d;">"""</span>
<span style="color: #556369;">    Summarize a CSV</span>

<span style="color: #556369;">    This function generates a dictionary that contains the summary</span>
<span style="color: #556369;">    of the CSV. It also performs some preprocessing on the column</span>
<span style="color: #556369;">    names by stripping off any whitespace before and after the column</span>
<span style="color: #556369;">    name and converting the column name to a snake-case. Furthermore,</span>
<span style="color: #556369;">    it also adds an "increment_&lt;column_name&gt;" key to the summary that</span>
<span style="color: #556369;">    records the increments used in the first column of the CSV.</span>
<span style="color: #556369;">    </span><span style="color: #c3e88d;">"""</span>
    <span style="color: #ffcb6b;">extension</span> <span style="color: #89DDFF;">=</span> os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">splitext</span>(filepath)[<span style="color: #f78c6c;">1</span>].<span style="color: #c792ea; font-weight: bold; font-style: italic;">lower</span>()
    <span style="color: #89DDFF;">if</span> extension <span style="color: #89DDFF;">==</span> <span style="color: #c3e88d;">".csv"</span>:
        <span style="color: #ffcb6b;">df</span> <span style="color: #89DDFF;">=</span> pd.<span style="color: #c792ea; font-weight: bold; font-style: italic;">read_csv</span>(filepath)
    <span style="color: #89DDFF;">elif</span> extension <span style="color: #89DDFF;">==</span> <span style="color: #c3e88d;">".txt"</span>:
        <span style="color: #ffcb6b;">df</span> <span style="color: #89DDFF;">=</span> pd.<span style="color: #c792ea; font-weight: bold; font-style: italic;">read_csv</span>(filepath, <span style="color: #89DDFF; font-weight: bold;">engine</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"python"</span>, <span style="color: #89DDFF; font-weight: bold;">sep</span><span style="color: #89DDFF;">=</span><span style="color: #82aaff;">None</span>)
    <span style="color: #89DDFF;">else</span>:
        <span style="color: #89DDFF;">return</span> <span style="color: #82aaff;">None</span>, <span style="color: #82aaff; font-weight: bold;">dict</span>()
    df.<span style="color: #ffcb6b; font-style: italic;">columns</span> <span style="color: #89DDFF;">=</span> df.<span style="color: #f78c6c; font-style: italic;">columns</span>.<span style="color: #f78c6c; font-style: italic;">str</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">strip</span>().<span style="color: #f78c6c; font-style: italic;">str</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">replace</span>(<span style="color: #c3e88d;">"\s+"</span>, <span style="color: #c3e88d;">" "</span>, <span style="color: #89DDFF; font-weight: bold;">regex</span><span style="color: #89DDFF;">=</span><span style="color: #82aaff;">True</span>).<span style="color: #f78c6c; font-style: italic;">str</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">lower</span>().<span style="color: #f78c6c; font-style: italic;">str</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">replace</span>(<span style="color: #c3e88d;">" "</span>, <span style="color: #c3e88d;">"_"</span>)
    <span style="color: #ffcb6b;">summary</span> <span style="color: #89DDFF;">=</span> df.<span style="color: #c792ea; font-weight: bold; font-style: italic;">describe</span>().<span style="color: #c792ea; font-weight: bold; font-style: italic;">to_dict</span>()
    <span style="color: #ffcb6b;">increment</span> <span style="color: #89DDFF;">=</span> df[df.<span style="color: #f78c6c; font-style: italic;">columns</span>[<span style="color: #f78c6c;">0</span>]].<span style="color: #f78c6c; font-style: italic;">iloc</span>[<span style="color: #f78c6c;">2</span>] <span style="color: #89DDFF;">-</span> df[df.<span style="color: #f78c6c; font-style: italic;">columns</span>[<span style="color: #f78c6c;">0</span>]].<span style="color: #f78c6c; font-style: italic;">iloc</span>[<span style="color: #f78c6c;">1</span>]
    summary[<span style="color: #ffcb6b;">f"increment_</span><span style="color: #ffcb6b;">{</span><span style="color: #ffcb6b; background-color: #263238;">df.</span><span style="color: #ffcb6b; background-color: #263238; font-style: italic;">columns</span><span style="color: #ffcb6b; background-color: #263238;">[</span><span style="color: #ffcb6b; background-color: #263238;">0</span><span style="color: #ffcb6b; background-color: #263238;">]</span><span style="color: #ffcb6b;">}</span><span style="color: #ffcb6b;">"</span>] <span style="color: #89DDFF;">=</span> increment
    <span style="color: #89DDFF;">return</span> df, summary


<span style="color: #556369;"># df, summary = summarize_csv("PRJ-3484/CDSS tests with Sig_v = 100 kPa, Dr = 66.7%, Alpha = 0/eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv")</span>
<span style="color: #ffcb6b;">df</span>, <span style="color: #ffcb6b;">summary</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">summarize_csv</span>(<span style="color: #c3e88d;">"PRJ-1783/Cyclic Stress-Controlled Triaxial Tests/eo_0_515_po_100/eo_0_515_po_100_csr_0_3.txt"</span>)
<span style="color: #c792ea; font-weight: bold;">pprint</span>(summary.<span style="color: #c792ea; font-weight: bold; font-style: italic;">keys</span>())
</pre>
</div>

<pre class="example">
dict_keys(['time_min', 'eps_a', 'eps_v', 'sigmap_3_kpa', 'sigma_3_kpa', 'sigma_d_kpa', 'increment_time_min'])
</pre>
</div>
</div>
<div id="outline-container-org702b80e" class="outline-2">
<h2 id="org702b80e"><span class="section-number-2">7.</span> Store information in a neo4j database</h2>
<div class="outline-text-2" id="text-7">
<p>
As starting step for creating the graph database, we&rsquo;ll create a structure that would enable the queries of the type
</p>

<blockquote>
<p>
What projects record information regarding shear<sub>strain</sub>?
</p>
</blockquote>
</div>

<div id="outline-container-orgb327795" class="outline-3">
<h3 id="orgb327795"><span class="section-number-3">7.1.</span> Connecting to a Neo4j database</h3>
<div class="outline-text-3" id="text-7-1">
<p>
I&rsquo;ve created a neo4j project locally. I can now use <kbd>py2neo</kbd> to connect to this database.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">from</span> py2neo <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Graph</span>

<span style="color: #ffcb6b;">tuitus_db</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Graph</span>(<span style="color: #c3e88d;">"bolt://localhost:7687"</span>, <span style="color: #89DDFF; font-weight: bold;">user</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"neo4j"</span>, <span style="color: #89DDFF; font-weight: bold;">password</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"tuitusci"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org8fef419" class="outline-3">
<h3 id="org8fef419"><span class="section-number-3">7.2.</span> Adding nodes</h3>
<div class="outline-text-3" id="text-7-2">
<p>
To add node for a project, say PRJ-3484, we use the <kbd>Graph.create</kbd> method with the <kbd>Node</kbd> class.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">from</span> py2neo <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Node</span>, <span style="color: #c792ea;">Relationship</span>

<span style="color: #ffcb6b;">project_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(<span style="color: #c3e88d;">"Project"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"PRJ-3484"</span>)
tuitus_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(project_node)
</pre>
</div>

<p>
This project will be supervised by a PI, information for which can be found in the project JSON.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #ffcb6b;">pi_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(<span style="color: #c3e88d;">"Author"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"mmanzari"</span>)
tuitus_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(pi_node)
<span style="color: #ffcb6b;">pi_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(pi_node, <span style="color: #c3e88d;">"SUPERVISES"</span>, project_node)
tuitus_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(pi_rel)
</pre>
</div>

<p>
A project can have multiple experiments, each of which can record different information.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #556369;"># len(tuitus_db.nodes.match("Project", name="PRJ-3484"))</span>

<span style="color: #ffcb6b;">project_id</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">"PRJ-3484"</span>
<span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">root</span>, <span style="color: #ffcb6b;">dirs</span>, <span style="color: #ffcb6b;">files</span> <span style="color: #89DDFF;">in</span> os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">walk</span>(project_id):
    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">f</span> <span style="color: #89DDFF;">in</span> files:
        <span style="color: #ffcb6b;">_</span>, <span style="color: #ffcb6b;">summary</span> <span style="color: #89DDFF;">=</span>
 <span style="color: #c792ea; font-weight: bold;">summarize_csv</span>(os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">join</span>(root, f))
        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">key</span> <span style="color: #89DDFF;">in</span> summary.<span style="color: #c792ea; font-weight: bold; font-style: italic;">keys</span>():
            <span style="color: #ffcb6b;">matching</span> <span style="color: #89DDFF;">=</span> tuitus_db.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Data"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>key)
            <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(matching) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
                <span style="color: #ffcb6b;">column_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(<span style="color: #c3e88d;">"Data"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>key)
                tuitus_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(column_node)
            <span style="color: #89DDFF;">else</span>:
                <span style="color: #ffcb6b;">column_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(matching)[<span style="color: #f78c6c;">0</span>]
            <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(tuitus_db.<span style="color: #f78c6c; font-style: italic;">relationships</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #89DDFF; font-weight: bold;">nodes</span><span style="color: #89DDFF;">=</span>(project_node, column_node), <span style="color: #89DDFF; font-weight: bold;">r_type</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"RECORDS"</span>)) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
                <span style="color: #ffcb6b;">col_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(project_node, <span style="color: #c3e88d;">"RECORDS"</span>, column_node)
                tuitus_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(col_rel)


</pre>
</div>

<p>
I can now combine all these steps into a single function that adds the nodes for a given project with files stored in a directory.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">def</span> <span style="color: #82aaff;">create_project_data_graph</span>(<span style="color: #ffcb6b;">project_id</span>, <span style="color: #ffcb6b;">project_path</span>, <span style="color: #ffcb6b;">pi</span>, <span style="color: #ffcb6b;">graph_db</span>):
    <span style="color: #ffcb6b;">project_matching</span> <span style="color: #89DDFF;">=</span> graph_db.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Project"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>project_id)
    <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(project_matching) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
        <span style="color: #ffcb6b;">project_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(<span style="color: #c3e88d;">"Project"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>project_id)
        graph_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(project_node)
    <span style="color: #89DDFF;">else</span>:
        <span style="color: #ffcb6b;">project_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(project_matching)[<span style="color: #f78c6c;">0</span>]
    <span style="color: #ffcb6b;">pi_matching</span> <span style="color: #89DDFF;">=</span> graph_db.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Author"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>pi)
    <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(pi_matching) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
        <span style="color: #ffcb6b;">pi_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(<span style="color: #c3e88d;">"Author"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>pi)
        graph_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(pi_node)
    <span style="color: #89DDFF;">else</span>:
        <span style="color: #ffcb6b;">pi_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(pi_matching)[<span style="color: #f78c6c;">0</span>]
    <span style="color: #ffcb6b;">pi_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(pi_node, <span style="color: #c3e88d;">"SUPERVISES"</span>, project_node)
    graph_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(pi_rel)

    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">root</span>, <span style="color: #ffcb6b;">dirs</span>, <span style="color: #ffcb6b;">files</span> <span style="color: #89DDFF;">in</span> os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">walk</span>(project_id):
        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">f</span> <span style="color: #89DDFF;">in</span> files:
            <span style="color: #ffcb6b;">_</span>, <span style="color: #ffcb6b;">summary</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">summarize_csv</span>(os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">join</span>(root, f))
            <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">key</span> <span style="color: #89DDFF;">in</span> summary.<span style="color: #c792ea; font-weight: bold; font-style: italic;">keys</span>():
                <span style="color: #ffcb6b;">matching</span> <span style="color: #89DDFF;">=</span> graph_db.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Data"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>key)
                <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(matching) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
                    <span style="color: #ffcb6b;">column_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(<span style="color: #c3e88d;">"Data"</span>, <span style="color: #89DDFF; font-weight: bold;">name</span><span style="color: #89DDFF;">=</span>key)
                    graph_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(column_node)
                <span style="color: #89DDFF;">else</span>:
                    <span style="color: #ffcb6b;">column_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(matching)[<span style="color: #f78c6c;">0</span>]
                <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(graph_db.<span style="color: #f78c6c; font-style: italic;">relationships</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #89DDFF; font-weight: bold;">nodes</span><span style="color: #89DDFF;">=</span>(project_node, column_node), <span style="color: #89DDFF; font-weight: bold;">r_type</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"RECORDS"</span>)) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
                    <span style="color: #ffcb6b;">col_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(project_node, <span style="color: #c3e88d;">"RECORDS"</span>, column_node)
                    graph_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(col_rel)

    <span style="color: #89DDFF;">return</span>


<span style="color: #556369;"># create_project_data_graph("PRJ-3484", "./", "mmanzari", tuitus_db)</span>
<span style="color: #556369;"># create_project_data_graph("PRJ-2137", "./", "mmanzari", tuitus_db)</span>
</pre>
</div>

<p>
This generates a graph db that can now answer the query mentioned above.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">tuitus_db.<span style="color: #c792ea; font-weight: bold; font-style: italic;">run</span>(<span style="color: #c3e88d;">"MATCH (p:PROJECT)-[:RECORDS]-&gt;(d:Data {name: 'cycle'}) RETURN p, d"</span>)
</pre>
</div>



<figure id="orgc413b6c">
<img src="../assets/2023-01-30_16-18-10_screenshot.png" alt="2023-01-30_16-18-10_screenshot.png">

</figure>
</div>
</div>
</div>
<div id="outline-container-orga551dce" class="outline-2">
<h2 id="orga551dce"><span class="section-number-2">8.</span> Extract experiment and model config information from the project JSON</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> requests
<span style="color: #89DDFF;">from</span> pprint <span style="color: #89DDFF;">import</span> pprint

<span style="color: #ffcb6b;">projectId</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">"PRJ-3484"</span>
<span style="color: #ffcb6b;">url</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">f"https://designsafe-ci.org/api/projects/publication/</span><span style="color: #89DDFF;">{</span><span style="color: #EEFFFF; background-color: #263238;">projectId</span><span style="color: #89DDFF;">}</span><span style="color: #c3e88d;">"</span>

<span style="color: #ffcb6b;">payload</span> <span style="color: #89DDFF;">=</span> <span style="color: #c3e88d;">""</span>
<span style="color: #ffcb6b;">headers</span> <span style="color: #89DDFF;">=</span> {}

<span style="color: #ffcb6b;">response</span> <span style="color: #89DDFF;">=</span> requests.<span style="color: #c792ea; font-weight: bold; font-style: italic;">request</span>(<span style="color: #c3e88d;">"GET"</span>, url, <span style="color: #89DDFF; font-weight: bold;">data</span><span style="color: #89DDFF;">=</span>payload, <span style="color: #89DDFF; font-weight: bold;">headers</span><span style="color: #89DDFF;">=</span>headers)
<span style="color: #ffcb6b;">response_json</span> <span style="color: #89DDFF;">=</span> response.<span style="color: #c792ea; font-weight: bold; font-style: italic;">json</span>()
</pre>
</div>

<ul class="org-ul">
<li>The response JSON has 3 top-level lists that are of interest - <kbd>eventsList</kbd>, <kbd>modelConfigs</kbd>, <kbd>experimentsList</kbd>. <kbd>experimentsList</kbd> is a list of all the experiments in the project. Each element of the list contains a <kbd>uuid</kbd> field that is used to link an experiment with a model config or an event. Furthermore, it also has <kbd>["value"]["title"]</kbd> which gives the name of the experiment.</li>
<li>Now, each element in <kbd>eventsList</kbd> and <kbd>modelConfigs</kbd> contains a field <kbd>["value"]["experiments"]</kbd> which is a list of all experiments that the event or the model config is a part of. All of this can be mapped to a project.</li>
<li>Each element in <kbd>eventsList</kbd> also has a <kbd>["value"]["modelConfigs"]</kbd> which is a list of uuids of models that an event is a part of.</li>
</ul>

<p>
With this information, I can now update the <code>create_project_graph</code> function to include everything.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #89DDFF;">import</span> os
<span style="color: #89DDFF;">from</span> py2neo <span style="color: #89DDFF;">import</span> <span style="color: #c792ea;">Graph</span>, <span style="color: #c792ea;">Node</span>, <span style="color: #c792ea;">Relationship</span>

<span style="color: #89DDFF;">def</span> <span style="color: #82aaff;">_create_or_return_node</span>(<span style="color: #ffcb6b;">node_type</span>, <span style="color: #ffcb6b;">node_key</span>, <span style="color: #ffcb6b;">graphdb</span>, <span style="color: #89DDFF;">**</span><span style="color: #ffcb6b;">node_props</span>):
    <span style="color: #ffcb6b;">matching</span> <span style="color: #89DDFF;">=</span> graphdb.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(node_type, <span style="color: #89DDFF;">**</span>node_key)
    <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(matching) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
        <span style="color: #ffcb6b;">node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Node</span>(node_type, <span style="color: #89DDFF;">**</span>node_props)
        graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(node)
    <span style="color: #89DDFF;">else</span>:
        <span style="color: #ffcb6b;">node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(matching)[<span style="color: #f78c6c;">0</span>]
    <span style="color: #89DDFF;">return</span> node

<span style="color: #89DDFF;">def</span> <span style="color: #82aaff;">create_project_graph</span>(<span style="color: #ffcb6b;">project_info</span>, <span style="color: #ffcb6b;">project_path</span>, <span style="color: #ffcb6b;">graphdb</span>):
    <span style="color: #ffcb6b;">project_id</span> <span style="color: #89DDFF;">=</span> project_info.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get</span>(<span style="color: #c3e88d;">"project_id"</span>, <span style="color: #82aaff;">None</span>)
    <span style="color: #89DDFF;">if</span> project_id <span style="color: #89DDFF;">is</span> <span style="color: #82aaff;">None</span>:
        <span style="color: #ffcb6b;">project_id</span> <span style="color: #89DDFF;">=</span> project_info.<span style="color: #c792ea; font-weight: bold; font-style: italic;">get</span>(<span style="color: #c3e88d;">"projectId"</span>, <span style="color: #82aaff;">None</span>)
    <span style="color: #89DDFF;">if</span> project_id <span style="color: #89DDFF;">is</span> <span style="color: #82aaff;">None</span>:
        <span style="color: #89DDFF;">raise</span> <span style="color: #c792ea; font-weight: bold;">KeyError</span>(<span style="color: #c3e88d;">"project_id or projectId not found in project info."</span>)

    <span style="color: #ffcb6b;">project_props</span> <span style="color: #89DDFF;">=</span> {<span style="color: #c3e88d;">"name"</span>: project_id}
    <span style="color: #ffcb6b;">project_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">_create_or_return_node</span>(
        <span style="color: #c3e88d;">"Project"</span>, {<span style="color: #c3e88d;">"name"</span>: project_id}, graphdb, <span style="color: #89DDFF;">**</span>project_props
    )

    <span style="color: #ffcb6b;">pi</span> <span style="color: #89DDFF;">=</span> project_info[<span style="color: #c3e88d;">"project"</span>][<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"pi"</span>]
    <span style="color: #ffcb6b;">pi_props</span> <span style="color: #89DDFF;">=</span> {<span style="color: #c3e88d;">"name"</span>: pi}
    <span style="color: #ffcb6b;">pi_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">_create_or_return_node</span>(
        <span style="color: #c3e88d;">"Author"</span>, {<span style="color: #c3e88d;">"name"</span>: pi}, graphdb, <span style="color: #89DDFF;">**</span>pi_props
    )
    <span style="color: #ffcb6b;">pi_project_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(pi_node, <span style="color: #c3e88d;">"SUPERVISES"</span>, project_node)
    graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(pi_project_rel)

    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">exp</span> <span style="color: #89DDFF;">in</span> project_info[<span style="color: #c3e88d;">"experimentsList"</span>]:
        <span style="color: #ffcb6b;">experiment_props</span> <span style="color: #89DDFF;">=</span> {
            <span style="color: #c3e88d;">"uuid"</span>: exp[<span style="color: #c3e88d;">"uuid"</span>],
            <span style="color: #c3e88d;">"title"</span>: exp[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"title"</span>],
        }
        <span style="color: #ffcb6b;">exp_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">_create_or_return_node</span>(
            <span style="color: #c3e88d;">"Experiment"</span>, {<span style="color: #c3e88d;">"uuid"</span>: exp[<span style="color: #c3e88d;">"uuid"</span>]}, graphdb, <span style="color: #89DDFF;">**</span>experiment_props
        )
        <span style="color: #ffcb6b;">exp_project_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(project_node, <span style="color: #c3e88d;">"HAS_EXPERIMENT"</span>, exp_node)
        graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(exp_project_rel)

    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">model</span> <span style="color: #89DDFF;">in</span> project_info[<span style="color: #c3e88d;">"modelConfigs"</span>]:
        <span style="color: #ffcb6b;">model_props</span> <span style="color: #89DDFF;">=</span> {
            <span style="color: #c3e88d;">"uuid"</span>: model[<span style="color: #c3e88d;">"uuid"</span>],
            <span style="color: #c3e88d;">"title"</span>: model[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"title"</span>],
        }
        <span style="color: #ffcb6b;">model_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">_create_or_return_node</span>(
            <span style="color: #c3e88d;">"Model"</span>, {<span style="color: #c3e88d;">"uuid"</span>: model[<span style="color: #c3e88d;">"uuid"</span>]}, graphdb, <span style="color: #89DDFF;">**</span>model_props
        )
        <span style="color: #ffcb6b;">model_exps</span> <span style="color: #89DDFF;">=</span> model[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"experiments"</span>]
        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">exp_uuid</span> <span style="color: #89DDFF;">in</span> model_exps:
            <span style="color: #ffcb6b;">exp_matching</span> <span style="color: #89DDFF;">=</span> graphdb.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Experiment"</span>, <span style="color: #89DDFF; font-weight: bold;">uuid</span><span style="color: #89DDFF;">=</span>exp_uuid)
            <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(exp_matching) <span style="color: #89DDFF;">&gt;</span> <span style="color: #f78c6c;">0</span>:
                <span style="color: #ffcb6b;">exp_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(exp_matching)[<span style="color: #f78c6c;">0</span>]
                <span style="color: #ffcb6b;">model_experiment_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(exp_node, <span style="color: #c3e88d;">"HAS_MODEL"</span>, model_node)
                graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(model_experiment_rel)

    <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">event</span> <span style="color: #89DDFF;">in</span> project_info[<span style="color: #c3e88d;">"eventsList"</span>]:
        <span style="color: #ffcb6b;">event_props</span> <span style="color: #89DDFF;">=</span> {
            <span style="color: #c3e88d;">"title"</span>: event[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"title"</span>],
        }
        <span style="color: #ffcb6b;">event_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">_create_or_return_node</span>(

            <span style="color: #c3e88d;">"Event"</span>, {<span style="color: #c3e88d;">"title"</span>: event_props[<span style="color: #c3e88d;">"title"</span>]}, graphdb, <span style="color: #89DDFF;">**</span>event_props
        )
        <span style="color: #ffcb6b;">event_exps</span> <span style="color: #89DDFF;">=</span> event[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"experiments"</span>]
        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">exp_uuid</span> <span style="color: #89DDFF;">in</span> event_exps:
            <span style="color: #ffcb6b;">exp_matching</span> <span style="color: #89DDFF;">=</span> graphdb.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Experiment"</span>, <span style="color: #89DDFF; font-weight: bold;">uuid</span><span style="color: #89DDFF;">=</span>exp_uuid)
            <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(exp_matching) <span style="color: #89DDFF;">&gt;</span> <span style="color: #f78c6c;">0</span>:
                <span style="color: #ffcb6b;">exp_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(exp_matching)[<span style="color: #f78c6c;">0</span>]
                <span style="color: #ffcb6b;">event_experiment_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(exp_node, <span style="color: #c3e88d;">"HAS_EVENT"</span>, event_node)
                graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(event_experiment_rel)

        <span style="color: #ffcb6b;">event_models</span> <span style="color: #89DDFF;">=</span> event[<span style="color: #c3e88d;">"value"</span>][<span style="color: #c3e88d;">"modelConfigs"</span>]
        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">model_uuid</span> <span style="color: #89DDFF;">in</span> event_models:
            <span style="color: #ffcb6b;">model_matching</span> <span style="color: #89DDFF;">=</span> graphdb.<span style="color: #f78c6c; font-style: italic;">nodes</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #c3e88d;">"Model"</span>, <span style="color: #89DDFF; font-weight: bold;">uuid</span><span style="color: #89DDFF;">=</span>model_uuid)
            <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(model_matching) <span style="color: #89DDFF;">&gt;</span> <span style="color: #f78c6c;">0</span>:
                <span style="color: #ffcb6b;">model_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #82aaff; font-weight: bold;">list</span>(model_matching)[<span style="color: #f78c6c;">0</span>]
                <span style="color: #ffcb6b;">event_model_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(model_node, <span style="color: #c3e88d;">"HAS_EVENT"</span>, event_node)
                graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(event_model_rel)

        <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">root</span>, <span style="color: #ffcb6b;">dirs</span>, <span style="color: #ffcb6b;">files</span> <span style="color: #89DDFF;">in</span> os.<span style="color: #c792ea; font-weight: bold; font-style: italic;">walk</span>(
                os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">join</span>(project_path, project_id, event_props[<span style="color: #c3e88d;">"title"</span>])
        ):
            <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">f</span> <span style="color: #89DDFF;">in</span> files:
                <span style="color: #ffcb6b;">_</span>, <span style="color: #ffcb6b;">summary</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">summarize_csv</span>(os.<span style="color: #f78c6c; font-style: italic;">path</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">join</span>(root, f))
                <span style="color: #89DDFF;">for</span> <span style="color: #ffcb6b;">key</span> <span style="color: #89DDFF;">in</span> summary.<span style="color: #c792ea; font-weight: bold; font-style: italic;">keys</span>():
                    <span style="color: #ffcb6b;">col_props</span> <span style="color: #89DDFF;">=</span> {<span style="color: #c3e88d;">"name"</span>: key}
                    <span style="color: #ffcb6b;">column_node</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">_create_or_return_node</span>(
                        <span style="color: #c3e88d;">"Data"</span>, {<span style="color: #c3e88d;">"name"</span>: key}, graphdb, <span style="color: #89DDFF;">**</span>col_props
                    )
                    <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(graphdb.<span style="color: #f78c6c; font-style: italic;">relationships</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #89DDFF; font-weight: bold;">nodes</span><span style="color: #89DDFF;">=</span>(project_node, column_node), <span style="color: #89DDFF; font-weight: bold;">r_type</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"RECORDS"</span>)) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
                        <span style="color: #ffcb6b;">col_proj_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(project_node, <span style="color: #c3e88d;">"RECORDS"</span>, column_node)
                        graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(col_proj_rel)
                    <span style="color: #89DDFF;">if</span> <span style="color: #82aaff; font-weight: bold;">len</span>(graphdb.<span style="color: #f78c6c; font-style: italic;">relationships</span>.<span style="color: #c792ea; font-weight: bold; font-style: italic;">match</span>(<span style="color: #89DDFF; font-weight: bold;">nodes</span><span style="color: #89DDFF;">=</span>(event_node, column_node), <span style="color: #89DDFF; font-weight: bold;">r_type</span><span style="color: #89DDFF;">=</span><span style="color: #c3e88d;">"RECORDS"</span>)) <span style="color: #89DDFF;">==</span> <span style="color: #f78c6c;">0</span>:
                        <span style="color: #ffcb6b;">col_event_rel</span> <span style="color: #89DDFF;">=</span> <span style="color: #c792ea; font-weight: bold;">Relationship</span>(event_node, <span style="color: #c3e88d;">"RECORDS"</span>, column_node)
                        graphdb.<span style="color: #c792ea; font-weight: bold; font-style: italic;">create</span>(col_event_rel)
    <span style="color: #89DDFF;">return</span>

<span style="color: #c792ea; font-weight: bold;">create_project_graph</span>(response_json, <span style="color: #c3e88d;">"./"</span>, tuitus_db)
</pre>
</div>

<p>
With this, we now have a much dense graph with relationships that can be queried.
</p>


<figure id="orgc45cd91">
<img src="../assets/Extract_experiment_and_model_config_information_from_the_project_JSON/2023-02-01_13-26-07_screenshot.png" alt="2023-02-01_13-26-07_screenshot.png" width="60%">

</figure>

<p>
Example query:
</p>

<blockquote>
<p>
List all the projects, experiments, models and events that record &ldquo;axial<sub>stress</sub>&rdquo;.
</p>
</blockquote>


<figure id="org0ddb265">
<img src="../assets/Extract_experiment_and_model_config_information_from_the_project_JSON/2023-02-01_13-34-40_screenshot.png" alt="2023-02-01_13-34-40_screenshot.png" width="60%">

</figure>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/>
<footer>
<div class="generated">
Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.6)
</div>
</footer>
</div>
</body>
</html>