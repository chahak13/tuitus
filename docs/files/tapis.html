<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-03-03 Fri 14:50 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tapis</title>
<meta name="author" content="Chahak Mehta" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="../style.css" type="text/css"/>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="preamble" class="status">
<div id="updated">Updated: 2023-03-03 Fri 14:50</div>
<nav>
<a href="/tuitus/">Home</a>
<a href="/tuitus/files/sitemap.html">Posts</a>
</nav>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Tapis</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org321ecc1">1. <kbd>tapis-cli</kbd></a></li>
<li><a href="#org5bf7cbf">2. Setting up a neo4j pod</a></li>
<li><a href="#orgd92a202">3. Fetching file information using <kbd>tapipy</kbd></a></li>
<li><a href="#org5a0b413">4. Get model configurations for experiments</a></li>
<li><a href="#orgafbde02">5. Use <code>requests</code> module to retrieve files for projects</a>
<ul>
<li><a href="#orgd9ebc63">5.1. Get a list of projects</a></li>
<li><a href="#orgc3d4da4">5.2. Get files for a project</a></li>
<li><a href="#org385c9df">5.3. Download entire project info together</a></li>
</ul>
</li>
<li><a href="#orge89d1b7">6. [DEPRECATED] Generate summary and metadata info for the files</a></li>
<li><a href="#org702b80e">7. Store information in a neo4j database</a>
<ul>
<li><a href="#orgb327795">7.1. Connecting to a Neo4j database</a></li>
<li><a href="#org8fef419">7.2. Adding nodes</a></li>
</ul>
</li>
<li><a href="#orga551dce">8. Extract experiment and model config information from the project JSON</a></li>
<li><a href="#orgb99b2ed">9. Update <code>summarize_csv</code> to include categorical variables and round decimals</a></li>
<li><a href="#org0522026">10. Querying database using <kbd>py2neo</kbd></a></li>
<li><a href="#org82b3beb">11. Modify project creation to support file path from response JSON</a></li>
</ul>
</div>
</nav>

<div id="outline-container-org321ecc1" class="outline-2">
<h2 id="org321ecc1"><span class="section-number-2">1.</span> <kbd>tapis-cli</kbd></h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<p>
Tapis CLI is a human-friendly, scriptable command line interface, implemented in Python, that helps scientists and engineers build and manage scalable computational and data science workflow projects using the <a href="https://tacc-cloud.readthedocs.io/projects/agave/en/latest/">Tapis</a> platform.
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-shell">tapis --version
</pre>
</div>

<pre class="example">
tapis 1.0.6
</pre>


<p>
To initialize a host, run <code>tapis auth init</code>
</p>

<div class="org-src-container">
<pre class="src src-shell">tapis auth init
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;Field&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;Value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;tenant_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;api_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;access_token&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;expires_at&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;verify&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;registry_url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;registry_username&nbsp;&nbsp;<br />
      &nbsp;registry_password&nbsp;&nbsp;<br />
      &nbsp;registry_namespace&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;designsafe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;chahak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Q***************************&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;f*******************************&nbsp;<br />
      &nbsp;Sat&nbsp;Jan&nbsp;&nbsp;7&nbsp;17:52:20&nbsp;2023&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;True&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;https://index.docker.io&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;chahak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;a*********U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;chahak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<p>
To list the files present in my default folder, I simply use the <code>tapis files list</code> command with the default storage location.
</p>
<div class="org-src-container">
<pre class="src src-shell">tapis files list agave://designsafe.storage.default/chahak/
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;lastModified&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;length&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;test-datadepot.txt&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;4&nbsp;hours&nbsp;ago&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;
    </td>
  </tr>
</table>

<p>
In this call, the <kbd>designsafe.storage.default</kbd> is the <i>systemId</i> where the data is stored and <i>chahak</i> is my username (and here, the default path). Both these information can be gleaned from the URL on the browser. For example, if the url is
</p>

<blockquote>
<p>
<a href="https://www.designsafe-ci.org/data/browser/public/designsafe.storage.community/Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses/University_of_Washington/freeFieldEffectiveJupyter">https://www.designsafe-ci.org/data/browser/public/designsafe.storage.community/Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses/University_of_Washington/freeFieldEffectiveJupyter</a>
</p>
</blockquote>

<p>
then, <code>systemId=designsafe.storage.community</code> and <code>path=Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses</code>. Therefore, the call would begin
</p>

<div class="org-src-container">
<pre class="src src-shell">tapis files list agave://designsafe.storage.community/Jupyter%20Notebooks%20for%20Civil%20Engineering%20Courses/University_of_Washington/freeFieldEffectiveJupyter
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;lastModified&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;length&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;ShortReport.rst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;ShortReport.tex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;exampleDescription.pptx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;freeFieldEffective.tcl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;freeFieldEffectiveJupyter_community.ipynb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;freeFieldEffectiveJupyter_community_2022-07-25&nbsp;22-40-57.ipynb&nbsp;<br />
      &nbsp;macros.tex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotAcc.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotPorepressure.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotProfile.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;plotStressStrain.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;respSpectra.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;schematic.eps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;schematic.png&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;short.tex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;untitled.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;velocity.input&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;6&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;8&nbsp;months&nbsp;ago&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;1380&nbsp;<br />
      &nbsp;&nbsp;&nbsp;1863&nbsp;<br />
      &nbsp;&nbsp;51605&nbsp;<br />
      &nbsp;&nbsp;17925&nbsp;<br />
      &nbsp;139950&nbsp;<br />
      &nbsp;140107&nbsp;<br />
      &nbsp;&nbsp;&nbsp;1954&nbsp;<br />
      &nbsp;&nbsp;&nbsp;1626&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;871&nbsp;<br />
      &nbsp;&nbsp;&nbsp;2791&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;620&nbsp;<br />
      &nbsp;&nbsp;&nbsp;2340&nbsp;<br />
      &nbsp;908760&nbsp;<br />
      &nbsp;&nbsp;&nbsp;5246&nbsp;<br />
      &nbsp;&nbsp;&nbsp;3346&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;<br />
      &nbsp;100260&nbsp;
    </td>
  </tr>
</table>

<p>
Similarly, if we want the information of a project, say <a href="https://www.designsafe-ci.org/data/browser/public/designsafe.storage.published/PRJ-3484">https://www.designsafe-ci.org/data/browser/public/designsafe.storage.published/PRJ-3484</a>,
</p>

<div class="org-src-container">
<pre class="src src-shell">tapis files list agave://designsafe.storage.published/PRJ-3484
</pre>
</div>

<!-- This HTML table template is generated by emacs 28.2 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;lastModified&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;length&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;CDSS_ResultsPlot.m&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Direct&nbsp;Simple&nbsp;Shear&nbsp;Experimental&nbsp;Setup.pdf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Direct&nbsp;Simple&nbsp;Shear&nbsp;Test&nbsp;Sensors.pdf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;Summary&nbsp;Report&nbsp;on&nbsp;Ottawa&nbsp;F65&nbsp;Sand&nbsp;CDSS&nbsp;Tests.pdf&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_160_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_210_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_240_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_250_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_576_sigv_40_CSR_0_300_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_150_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_200_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_588_sigv_40_CSR_0_230_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_180_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_200_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_210_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_220_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_600_sigv_100_CSR_0_250_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_150_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_200_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_250_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_300_Tau_30_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_150_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_200_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_200_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_210_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_220_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_220_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_220_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_230_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_230_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_240_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_250_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_250_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_250_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_270_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_270_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_300_Tau_10_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_300_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_320_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_601_sigv_40_CSR_0_350_Tau_15_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_100_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_120_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_140_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_150_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_170_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_180_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
      &nbsp;eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;<br />
      &nbsp;2&nbsp;months&nbsp;ago&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3780&nbsp;<br />
      &nbsp;&nbsp;&nbsp;333090&nbsp;<br />
      &nbsp;&nbsp;&nbsp;132480&nbsp;<br />
      &nbsp;11470561&nbsp;<br />
      &nbsp;&nbsp;&nbsp;367421&nbsp;<br />
      &nbsp;&nbsp;&nbsp;266759&nbsp;<br />
      &nbsp;&nbsp;&nbsp;133005&nbsp;<br />
      &nbsp;&nbsp;&nbsp;106531&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;73409&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;48243&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;20694&nbsp;<br />
      &nbsp;&nbsp;&nbsp;426255&nbsp;<br />
      &nbsp;&nbsp;&nbsp;145600&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;75184&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;57140&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;76043&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;39150&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;24488&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;29512&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;20205&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;19307&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;11603&nbsp;<br />
      &nbsp;&nbsp;1350936&nbsp;<br />
      &nbsp;&nbsp;&nbsp;740401&nbsp;<br />
      &nbsp;&nbsp;&nbsp;111957&nbsp;<br />
      &nbsp;&nbsp;&nbsp;194061&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;50388&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;65815&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;22568&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;41252&nbsp;<br />
      &nbsp;&nbsp;&nbsp;253281&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;95541&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;62701&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;51772&nbsp;<br />
      &nbsp;&nbsp;&nbsp;956617&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;45227&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;28760&nbsp;<br />
      &nbsp;&nbsp;&nbsp;428522&nbsp;<br />
      &nbsp;&nbsp;2254872&nbsp;<br />
      &nbsp;&nbsp;&nbsp;351036&nbsp;<br />
      &nbsp;&nbsp;1757060&nbsp;<br />
      &nbsp;&nbsp;&nbsp;282245&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;12117&nbsp;<br />
      &nbsp;&nbsp;&nbsp;204689&nbsp;<br />
      &nbsp;&nbsp;&nbsp;661142&nbsp;<br />
      &nbsp;&nbsp;&nbsp;196049&nbsp;<br />
      &nbsp;&nbsp;&nbsp;688310&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;40408&nbsp;<br />
      &nbsp;&nbsp;&nbsp;447705&nbsp;<br />
      &nbsp;&nbsp;&nbsp;447356&nbsp;<br />
      &nbsp;&nbsp;&nbsp;128002&nbsp;<br />
      &nbsp;&nbsp;&nbsp;819420&nbsp;<br />
      &nbsp;&nbsp;&nbsp;219298&nbsp;<br />
      &nbsp;&nbsp;&nbsp;138572&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;91315&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;54473&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;58544&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;48529&nbsp;
    </td>
  </tr>
</table>
</div>
</div>

<div id="outline-container-org5bf7cbf" class="outline-2">
<h2 id="org5bf7cbf"><span class="section-number-2">2.</span> Setting up a neo4j pod</h2>
<div class="outline-text-2" id="text-2">
<p>
Ref: <a href="https://tapis.readthedocs.io/en/latest/technical/pods.html">https://tapis.readthedocs.io/en/latest/technical/pods.html</a>
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Create TACC Account
<ul class="org-ul">
<li>Username: <kbd>chahak</kbd></li>
</ul></li>
<li class="on"><code>[X]</code> Create Docker
<ul class="org-ul">
<li>Username: <kbd>chahak</kbd></li>
</ul></li>
<li class="on"><code>[X]</code> <p>
Install Tapis Python SDK
</p>
<div class="org-src-container">
<pre class="src src-shell">pipenv install tapipy
</pre>
</div></li>
<li class="on"><code>[X]</code> TACC OAuth
<ul class="org-ul">
<li class="on"><code>[X]</code> <p>
Create Tapis Client Object
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> os
<span style="color: #b6a0ff;">from</span> tapipy.tapis <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Tapis</span>

<span style="color: #00d3d0;">t</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Tapis</span>(<span style="color: #ff9077;">base_url</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"https://icicle.tapis.io"</span>,
          <span style="color: #ff9077;">username</span><span style="color: #b6a0ff;">=</span>os.<span style="color: #00bcff; font-style: italic;">getenv</span>(<span style="color: #79a8ff;">"TACC_USERNAME"</span>),
          <span style="color: #ff9077;">password</span><span style="color: #b6a0ff;">=</span>os.<span style="color: #00bcff; font-style: italic;">getenv</span>(<span style="color: #79a8ff;">"TACC_PASSWORD"</span>))

t.<span style="color: #00bcff; font-style: italic;">get_tokens</span>()
t.<span style="color: #00bcff; font-style: italic;">access_token</span>.<span style="color: #00bcff; font-style: italic;">access_token</span>
</pre>
</div>

<pre class="example">
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9...
</pre></li>

<li class="on"><code>[X]</code> <p>
Check Access to the Tapis API
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #00bcff; font-style: italic;">authenticator</span>.<span style="color: #00bcff; font-style: italic;">get_profile</span>(<span style="color: #ff9077;">username</span><span style="color: #b6a0ff;">=</span>os.<span style="color: #00bcff; font-style: italic;">getenv</span>(<span style="color: #79a8ff;">"TACC_USERNAME"</span>))
</pre>
</div>

<pre class="example">

create_time: None
dn: cn=chahak,ou=People,dc=tacc,dc=utexas,dc=edu
email: chahak@utexas.edu
given_name: Chahak
last_name: Mehta
mobile_phone: None
phone: None
uid: 875122
username: chahak
</pre></li>
</ul></li>

<li class="on"><code>[X]</code> <p>
Registering a templated Pod
To register a pod, we use the <code>pods.create_pod()</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #00bcff; font-style: italic;">pods</span>.<span style="color: #00bcff; font-style: italic;">create_pod</span>(<span style="color: #ff9077;">pod_id</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"tuitustestpod"</span>, <span style="color: #ff9077;">pod_template</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"neo4j"</span>, <span style="color: #ff9077;">description</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"Creating test pod"</span>)
</pre>
</div>

<pre class="example" id="org1228bb5">

  command: None
  creation_ts: 2023-01-06T15:34:20.551402
  data_attached: []
  data_requests: []
  description: Creating test pod
  environment_variables:

  networking:
  default:
  port: 7687
  protocol: tcp
  url: tuitustestpod.pods.icicle.tapis.io
  persistent_volume:

  pod_id: tuitustestpod
  pod_template: neo4j
  resources:
  cpu_limit: 2000
  cpu_request: 250
  mem_limit: 3072
  mem_request: 256
  roles_inherited: []
  roles_required: []
  start_instance_ts: None
  status: REQUESTED
  status_container:

  status_requested: ON
  time_to_stop_default: 43200
  time_to_stop_instance: None
  time_to_stop_ts: None
  update_ts: 2023-01-06T15:34:20.551422
</pre></li>
</ul>


<p>
The details and status of this <kbd>REQUESTED</kbd> pod can be accessed using the <code>get_pod()</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #00bcff; font-style: italic;">pods</span>.<span style="color: #00bcff; font-style: italic;">get_pod</span>(<span style="color: #ff9077;">pod_id</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"tuitustestpod"</span>)
</pre>
</div>

<pre class="example" id="org1eb37ab">

command: None
creation_ts: 2023-01-06T15:34:20.551402
data_attached: []
data_requests: []
description: Creating test pod
environment_variables:

networking:
default:
port: 7687
protocol: tcp
url: tuitustestpod.pods.icicle.tapis.io
persistent_volume:

pod_id: tuitustestpod
pod_template: neo4j
resources:
cpu_limit: 2000
cpu_request: 250
mem_limit: 3072
mem_request: 256
roles_inherited: []
roles_required: []
start_instance_ts: 2023-01-06T16:06:34.268462
status: RUNNING
status_container:
message: Pod is running.
phase: Running
start_time: 2023-01-06T16:06:17.000000
status_requested: ON
time_to_stop_default: 43200
time_to_stop_instance: None
time_to_stop_ts: 2023-01-07T04:06:34.270380
update_ts: 2023-01-06T15:34:20.551422
</pre>

<p>
The logs can be retrieved using the <code>get_pod_logs()</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #00bcff; font-style: italic;">pods</span>.<span style="color: #00bcff; font-style: italic;">get_pod_logs</span>(<span style="color: #ff9077;">pod_id</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"tuitustestpod"</span>)
</pre>
</div>

<pre class="example" id="org978ebba">

logs: 2023-01-06 16:06:39.132+0000 INFO  Starting...
2023-01-06 16:06:40.347+0000 INFO  This instance is ServerId{e6102ec8} (e6102ec8-c9a0-4650-b0df-b523b7475f5a)
2023-01-06 16:06:42.487+0000 INFO  ======== Neo4j 4.4.16 ========
2023-01-06 16:06:48.846+0000 INFO  [system/00000000] successfully initialized: CREATE USER podsservice IF NOT EXISTS SET PLAINTEXT PASSWORD 'servicepass' SET PASSWORD CHANGE NOT REQUIRED
2023-01-06 16:06:49.145+0000 INFO  [system/00000000] successfully initialized: CREATE USER tuitustestpod IF NOT EXISTS SET PLAINTEXT PASSWORD 'userpass' SET PASSWORD CHANGE NOT REQUIRED
2023-01-06 16:06:56.019+0000 INFO  Upgrading security graph to latest version
2023-01-06 16:06:56.020+0000 INFO  Setting version for 'security-users' to 2
2023-01-06 16:06:56.022+0000 INFO  Upgrading 'security-users' version property from 2 to 3
2023-01-06 16:06:56.283+0000 INFO  Called db.clearQueryCaches(): Query cache already empty.
2023-01-06 16:06:56.439+0000 INFO  Bolt enabled on [0:0:0:0:0:0:0:0%0]:7687.
2023-01-06 16:06:57.632+0000 INFO  Remote interface available at http://pods-tacc-icicle-tuitustestpod:7474/
2023-01-06 16:06:57.637+0000 INFO  id: 8ACF4A544C1C241897F7E92DEED8D4D2266674C622192A7F52378EF69EA3644A
2023-01-06 16:06:57.637+0000 INFO  name: system
2023-01-06 16:06:57.637+0000 INFO  creationDate: 2023-01-06T16:06:43.669Z
2023-01-06 16:06:57.637+0000 INFO  Started.
</pre>

<p>
List of all pods - <code>get_pods()</code>
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #f78fe7;">print</span>(t.<span style="color: #00bcff; font-style: italic;">pods</span>.<span style="color: #00bcff; font-style: italic;">get_pods</span>())
</pre>
</div>

<pre class="example" id="org2d60449">
[
command: None
creation_ts: 2023-01-06T15:34:20.551402
data_attached: []
data_requests: []
description: Creating test pod
environment_variables: 

networking: 
default: 
port: 7687
protocol: tcp
url: tuitustestpod.pods.icicle.tapis.io
persistent_volume: 

pod_id: tuitustestpod
pod_template: neo4j
resources: 
cpu_limit: 2000
cpu_request: 250
mem_limit: 3072
mem_request: 256
roles_inherited: []
roles_required: []
start_instance_ts: 2023-01-06T16:06:34.268462
status: RUNNING
status_container: 
message: Pod is running.
phase: Running
start_time: 2023-01-06T16:06:17.000000
status_requested: ON
time_to_stop_default: 43200
time_to_stop_instance: None
time_to_stop_ts: 2023-01-07T04:06:34.270380
update_ts: 2023-01-06T15:34:20.551422]
</pre>


<p>
Any pod can be deleted using the <code>delete_pod(pod_id)</code> method.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #00bcff; font-style: italic;">pods</span>.<span style="color: #00bcff; font-style: italic;">delete_pod</span>(<span style="color: #ff9077;">pod_id</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"tuitustestpod"</span>)
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">message</td>
<td class="org-left">:</td>
<td class="org-left">Pod successfully deleted.</td>
<td class="org-left">metadata</td>
<td class="org-left">:</td>
<td class="org-left">nil</td>
<td class="org-left">result</td>
<td class="org-left">:</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">status</td>
<td class="org-left">:</td>
<td class="org-left">success</td>
<td class="org-left">version</td>
<td class="org-left">:</td>
<td class="org-left">dev</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgd92a202" class="outline-2">
<h2 id="orgd92a202"><span class="section-number-2">3.</span> Fetching file information using <kbd>tapipy</kbd></h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><p>
Create <code>Tapis</code> object and generate a token.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> os
<span style="color: #b6a0ff;">from</span> tapipy.tapis <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Tapis</span>

<span style="color: #00d3d0;">t</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Tapis</span>(<span style="color: #ff9077;">base_url</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"https://designsafe.tapis.io"</span>,
          <span style="color: #ff9077;">username</span><span style="color: #b6a0ff;">=</span>os.<span style="color: #00bcff; font-style: italic;">getenv</span>(<span style="color: #79a8ff;">"TACC_USERNAME"</span>),
          <span style="color: #ff9077;">password</span><span style="color: #b6a0ff;">=</span>os.<span style="color: #00bcff; font-style: italic;">getenv</span>(<span style="color: #79a8ff;">"TACC_PASSWORD"</span>))
t.<span style="color: #00bcff; font-style: italic;">get_tokens</span>()
<span style="color: #a8a8a8;"># t.access_token</span>
</pre>
</div>

<p>
Using the <code>systemId</code> as <kbd>designsafe.storage.default</kbd>, fetch files.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">t.<span style="color: #00bcff; font-style: italic;">files</span>.<span style="color: #00bcff; font-style: italic;">listFiles</span>(<span style="color: #ff9077;">systemId</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"designsafe.storage.default"</span>, <span style="color: #ff9077;">path</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"chahak"</span>)
</pre>
</div>

<pre class="example" id="org41db3ee">
  ---------------------------------------------------------------------------
  NotFoundError                             Traceback (most recent call last)
  Cell In[6], line 1
  ----&gt; 1 t.files.listFiles(systemId="designsafe.storage.default", path="chahak")

  File ~/.local/share/virtualenvs/tuitus-75BIUZJs/lib/python3.9/site-packages/tapipy/tapis.py:1191, in Operation.__call__(self, **kwargs)
     1189     raise errors.ForbiddenError(msg=error_msg, version=version, request=r, response=resp)
     1190 if resp.status_code == 404:
  -&gt; 1191     raise errors.NotFoundError(msg=error_msg, version=version, request=r, response=resp)
     1192 if resp.status_code == 503:
     1193     raise errors.ServiceUnavailableError(msg=error_msg, version=version, request=r, response=resp)

  NotFoundError: message: SYSAPI_NOT_FOUND Record not found. jwtTenant: admin jwtUser: files OboTenant: designsafe OboUser: chahak System: designsafe.storage.default
</pre>

<p>
Seems like tapipy is using v3 apis which doesn&rsquo;t seem to have any systems that it retrieves via <code>getSystems()</code> on <kbd>designsafe</kbd>. Not sure if I can work with this right now.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org5a0b413" class="outline-2">
<h2 id="org5a0b413"><span class="section-number-2">4.</span> Get model configurations for experiments</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>I&rsquo;m trying to find a way to get information about the model configurations and experiment setup on this page. I found using inspect element that there is an API call to <a href="https://www.designsafe-ci.org/api/projects/publication/PRJ-3484/">https://www.designsafe-ci.org/api/projects/publication/PRJ-3484/</a> and that has a field for <kbd>modelConfigs</kbd> that has experiments but it has <kbd>associationIds</kbd> which are UUIDs if I&rsquo;m not wrong, and the above API is the only way I could find to resolve UUIDs but it doesn&rsquo;t seem to be working.</li>
<li>According to Dr. Krishna, UUID lookup is not available in designsafe yet so letting this be for now.</li>
</ul>
</div>
</div>
<div id="outline-container-orgafbde02" class="outline-2">
<h2 id="orgafbde02"><span class="section-number-2">5.</span> Use <code>requests</code> module to retrieve files for projects</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>Even without model configs for experiments, next thing to do is to get all the files for all the projects.</li>
</ul>
</div>
<div id="outline-container-orgd9ebc63" class="outline-3">
<h3 id="orgd9ebc63"><span class="section-number-3">5.1.</span> Get a list of projects</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Using the <code>requests</code> module, we can create a request to <kbd>https://designsafe-ci.org/api/publications/listing</kbd> to get a list of the projects.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">from</span> pprint <span style="color: #b6a0ff;">import</span> pprint
<span style="color: #b6a0ff;">import</span> requests

<span style="color: #00d3d0;">url</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">"https://designsafe-ci.org/api/publications/listing"</span>

<span style="color: #00d3d0;">querystring</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"limit"</span>:<span style="color: #79a8ff;">"3"</span>}

<span style="color: #00d3d0;">payload</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">""</span>
<span style="color: #00d3d0;">headers</span> <span style="color: #b6a0ff;">=</span> {
    <span style="color: #a8a8a8;"># "cookie": "django_language=en-us",</span>
    <span style="color: #a8a8a8;"># "Host": "www.designsafe-ci.org",</span>
    <span style="color: #79a8ff;">"User-Agent"</span>: <span style="color: #79a8ff;">"Mozilla/5.0 (X11; Linux x86_64; rv:108.0) Gecko/20100101 Firefox/108.0"</span>,
    <span style="color: #79a8ff;">"Accept"</span>: <span style="color: #79a8ff;">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>,
    <span style="color: #79a8ff;">"Accept-Language"</span>: <span style="color: #79a8ff;">"en-US,en;q=0.5"</span>,
    <span style="color: #79a8ff;">"Accept-Encoding"</span>: <span style="color: #79a8ff;">"gzip, deflate, br"</span>,
    <span style="color: #79a8ff;">"DNT"</span>: <span style="color: #79a8ff;">"1"</span>,
    <span style="color: #79a8ff;">"Connection"</span>: <span style="color: #79a8ff;">"keep-alive"</span>,
    <span style="color: #79a8ff;">"Upgrade-Insecure-Requests"</span>: <span style="color: #79a8ff;">"1"</span>,
    <span style="color: #79a8ff;">"Sec-Fetch-Dest"</span>: <span style="color: #79a8ff;">"document"</span>,
    <span style="color: #79a8ff;">"Sec-Fetch-Mode"</span>: <span style="color: #79a8ff;">"navigate"</span>,
    <span style="color: #79a8ff;">"Sec-Fetch-Site"</span>: <span style="color: #79a8ff;">"none"</span>,
    <span style="color: #79a8ff;">"Sec-Fetch-User"</span>: <span style="color: #79a8ff;">"?1"</span>,
    <span style="color: #79a8ff;">"TE"</span>: <span style="color: #79a8ff;">"trailers"</span>
}

<span style="color: #00d3d0;">response</span> <span style="color: #b6a0ff;">=</span> requests.<span style="color: #00bcff; font-style: italic;">request</span>(<span style="color: #79a8ff;">"GET"</span>, url, <span style="color: #ff9077;">data</span><span style="color: #b6a0ff;">=</span>payload, <span style="color: #ff9077;">headers</span><span style="color: #b6a0ff;">=</span>headers, <span style="color: #ff9077;">params</span><span style="color: #b6a0ff;">=</span>querystring)

<span style="color: #00bcff;">pprint</span>(response.<span style="color: #00bcff; font-style: italic;">json</span>())
</pre>
</div>

<pre class="example" id="org73a3eb6">
{'listing': [{'created': '2023-01-09T21:13:07.982682',
              'pi': 'Zhang, Wenyang',
              'project': {'value': {'keywords': 'Physics-based ground motion '
                                                'simulation, loss and '
                                                'resilience assessments, '
                                                'regional analysis, Hercules, '
                                                'SimCenter R2D',
                                    'pi': 'wz_tacc',
                                    'projectType': 'simulation',
                                    'title': 'Regional-scale physics-based '
                                             'ground motion simulation for '
                                             'Istanbul, Turkey'}},
              'projectId': 'PRJ-3712'},
             {'created': '2023-01-09T18:06:55.086860',
              'pi': 'Akin, Idil Deniz',
              'project': {'value': {'keywords': 'suction, water content, '
                                                'post-wildfire',
                                    'pi': 'idil',
                                    'projectType': 'field_recon',
                                    'title': '2019 Williams Flats Wildfire '
                                             'Slope Stability'}},
              'projectId': 'PRJ-3685'},
             {'created': '2023-01-09T01:52:04.001722',
              'pi': 'Matta, Fabio',
              'project': {'value': {'keywords': 'Compressive strength, earth '
                                                'masonry, isotropy, '
                                                'homogeneity, statistical '
                                                'analysis',
                                    'pi': 'fmatta',
                                    'projectType': 'experimental',
                                    'title': 'Physico-Mechanical '
                                             'Characterization of Homogeneity '
                                             'and Isotropy of Prototype Earth '
                                             'Block Material'}},
              'projectId': 'PRJ-2809'}]}
</pre>
</div>
</div>


<div id="outline-container-orgc3d4da4" class="outline-3">
<h3 id="orgc3d4da4"><span class="section-number-3">5.2.</span> Get files for a project</h3>
<div class="outline-text-3" id="text-5-2">
<p>
For a given <kbd>projectId</kbd>, we need to get all the result files. The information for projects can be fetched from <kbd>https://designsafe-ci.org/api/projects/publication/{projectId}</kbd>. For example,
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00d3d0;">projectId</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">"PRJ-3484"</span>
<span style="color: #00d3d0;">url</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"https://designsafe-ci.org/api/projects/publication/</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">projectId</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>

<span style="color: #00d3d0;">payload</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">""</span>
<span style="color: #00d3d0;">headers</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"cookie"</span>: <span style="color: #79a8ff;">"django_language=en-us"</span>}

<span style="color: #00d3d0;">response</span> <span style="color: #b6a0ff;">=</span> requests.<span style="color: #00bcff; font-style: italic;">request</span>(<span style="color: #79a8ff;">"GET"</span>, url, <span style="color: #ff9077;">data</span><span style="color: #b6a0ff;">=</span>payload, <span style="color: #ff9077;">headers</span><span style="color: #b6a0ff;">=</span>headers)
<span style="color: #00d3d0;">response_json</span> <span style="color: #b6a0ff;">=</span> response.<span style="color: #00bcff; font-style: italic;">json</span>()
</pre>
</div>

<ul class="org-ul">
<li>The response is a humongous \(\sym\) 1300 lines json object which contains basically all the information about the project that is present on the website. The fields of major importance right now would be <code>["eventsList"]</code>. This corresponds to the different experiment setups.</li>
<li>For every element in <code>"eventsList"</code>, <code>"fileObjs"</code> is the list of files for that experiment, <code>["value"]["title"]</code> is the title string of the experiment.</li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00d3d0;">files_info</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">dict</span>()
<span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">i</span>, <span style="color: #00d3d0;">event</span> <span style="color: #b6a0ff;">in</span> <span style="color: #f78fe7;">enumerate</span>(response_json[<span style="color: #79a8ff;">"eventsList"</span>]):
    files_info[<span style="color: #00d3d0;">i</span>] <span style="color: #b6a0ff;">=</span> {
        <span style="color: #79a8ff;">"title"</span>: event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        <span style="color: #79a8ff;">"files"</span>: event[<span style="color: #79a8ff;">"fileObjs"</span>]
        }
<span style="color: #00bcff;">pprint</span>(files_info[<span style="color: #00bcff;">0</span>])
</pre>
</div>

<pre class="example" id="org193852f">
{'files': [{'name': 'eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'},
           {'name': 'eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'},
           {'name': 'eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'},
           {'name': 'eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv',
            'path': '/eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv',
            'system': 'project-3122606422211489300-242ac118-0001-012',
            'type': 'file'}],
 'title': 'CDSS tests with Sig_v = 100 kPa, Dr = 67%, Alpha = 0.4'}
</pre>

<p>
Now, to download any of those file, I can either create a request manually or use <code>tapis cli</code> to download it.
</p>

<div class="org-src-container">
<pre class="src src-bash">tapis files download agave://designsafe.storage.published/PRJ-3484/eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv
</pre>
</div>

<p>
<code>tapis cli</code> doesn&rsquo;t seem to allow specifying an output directory to save the file to, which is definitely not great as I&rsquo;ll have to either move them myself or change directory every time before saving the file. On the other hand, it has some support for multi-threaded downloads. Need more investigation on this.
</p>

<p>
On the other hand, <code>tapis cli</code> uses <code>agavepy</code> to download the files. So, for now, I could potentially use that directly to download these files.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">from</span> agavepy <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Agave</span>
<span style="color: #00d3d0;">ag</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Agave</span>.<span style="color: #00bcff; font-style: italic;">restore</span>()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00d3d0;">rsp</span> <span style="color: #b6a0ff;">=</span> ag.<span style="color: #00bcff; font-style: italic;">files</span>.<span style="color: #00bcff; font-style: italic;">download</span>(<span style="color: #ff9077;">systemId</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"designsafe.storage.published"</span>, <span style="color: #ff9077;">filePath</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"PRJ-3484/eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv"</span>)
<span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">isinstance</span>(rsp, dict):
    <span style="color: #b6a0ff;">raise</span> <span style="color: #6ae4b9;">Error</span>(<span style="color: #79a8ff;">f"Failed to download"</span>)
<span style="color: #b6a0ff;">with</span> <span style="color: #f78fe7;">open</span>(<span style="color: #79a8ff;">'test.csv'</span>, <span style="color: #79a8ff;">'wb'</span>) <span style="color: #b6a0ff;">as</span> dest_file:
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">block</span> <span style="color: #b6a0ff;">in</span> rsp.<span style="color: #00bcff; font-style: italic;">iter_content</span>(<span style="color: #00bcff;">4096</span>):
        <span style="color: #b6a0ff;">if</span> <span style="color: #b6a0ff;">not</span> block:
            <span style="color: #b6a0ff;">break</span>
        dest_file.<span style="color: #00bcff; font-style: italic;">write</span>(block)

<span style="color: #f78fe7;">print</span>(os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">isfile</span>(<span style="color: #79a8ff;">'test.csv'</span>))
</pre>
</div>

<pre class="example">
True
</pre>


<p>
This tests works. So, I can create a function to do this and create a folder structure with files based on the experiment titles.
</p>
</div>
</div>

<div id="outline-container-org385c9df" class="outline-3">
<h3 id="org385c9df"><span class="section-number-3">5.3.</span> Download entire project info together</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Now it is time to combine all of the above together to get all the files of a project in a single go.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> os
<span style="color: #b6a0ff;">import</span> requests
<span style="color: #b6a0ff;">from</span> tqdm <span style="color: #b6a0ff;">import</span> tqdm
<span style="color: #b6a0ff;">from</span> agavepy <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Agave</span>
<span style="color: #00d3d0;">ag</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Agave</span>.<span style="color: #00bcff; font-style: italic;">restore</span>()


<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">download_file</span>(<span style="color: #00d3d0;">filepath</span>, <span style="color: #00d3d0;">dirpath</span>):
    <span style="color: #00d3d0;">rsp</span> <span style="color: #b6a0ff;">=</span> ag.<span style="color: #00bcff; font-style: italic;">files</span>.<span style="color: #00bcff; font-style: italic;">download</span>(<span style="color: #ff9077;">systemId</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"designsafe.storage.published"</span>,
                            <span style="color: #ff9077;">filePath</span><span style="color: #b6a0ff;">=</span>filepath)
    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">isinstance</span>(rsp, dict):
        <span style="color: #b6a0ff;">raise</span> <span style="color: #6ae4b9;">Error</span>(<span style="color: #79a8ff;">f"Failed to download: </span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">filepath</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>)
    <span style="color: #b6a0ff;">if</span> <span style="color: #b6a0ff;">not</span> os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">isdir</span>(dirpath):
        os.<span style="color: #00bcff; font-style: italic;">makedirs</span>(dirpath)
    <span style="color: #b6a0ff;">with</span> <span style="color: #f78fe7;">open</span>(os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">join</span>(dirpath, os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">basename</span>(filepath)), <span style="color: #79a8ff;">"wb"</span>) <span style="color: #b6a0ff;">as</span> f:
        <span style="color: #b6a0ff;">try</span>:
            <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">block</span> <span style="color: #b6a0ff;">in</span> rsp.<span style="color: #00bcff; font-style: italic;">iter_content</span>(<span style="color: #00bcff;">4096</span>):
                <span style="color: #b6a0ff;">if</span> <span style="color: #b6a0ff;">not</span> block:
                    <span style="color: #b6a0ff;">break</span>
                f.<span style="color: #00bcff; font-style: italic;">write</span>(block)
        <span style="color: #b6a0ff;">except</span> <span style="color: #6ae4b9;">Exception</span> <span style="color: #b6a0ff;">as</span> e:
            <span style="color: #b6a0ff;">raise</span> e
    <span style="color: #b6a0ff;">return</span> <span style="color: #f78fe7;">True</span>


<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">download_project</span>(<span style="color: #00d3d0;">projectId</span>):
    <span style="color: #00d3d0;">url</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"https://designsafe-ci.org/api/projects/publication/</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">projectId</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>

    <span style="color: #00d3d0;">payload</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">""</span>
    <span style="color: #00d3d0;">headers</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">""</span>

    <span style="color: #00d3d0;">response</span> <span style="color: #b6a0ff;">=</span> requests.<span style="color: #00bcff; font-style: italic;">get</span>(url, <span style="color: #ff9077;">data</span><span style="color: #b6a0ff;">=</span>payload, <span style="color: #ff9077;">headers</span><span style="color: #b6a0ff;">=</span>headers)
    <span style="color: #00d3d0;">response_json</span> <span style="color: #b6a0ff;">=</span> response.<span style="color: #00bcff; font-style: italic;">json</span>()

    <span style="color: #00d3d0;">files_info</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">dict</span>()
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">i</span>, <span style="color: #00d3d0;">event</span> <span style="color: #b6a0ff;">in</span> <span style="color: #f78fe7;">enumerate</span>(response_json[<span style="color: #79a8ff;">"eventsList"</span>]):
        files_info[<span style="color: #00d3d0;">i</span>] <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"title"</span>: event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
            <span style="color: #79a8ff;">"files"</span>: event[<span style="color: #79a8ff;">"fileObjs"</span>],
        }

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">event</span>, <span style="color: #00d3d0;">data</span> <span style="color: #b6a0ff;">in</span> <span style="color: #00bcff;">tqdm</span>(files_info.<span style="color: #00bcff; font-style: italic;">items</span>()):
        <span style="color: #00d3d0;">dirpath</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">projectId</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">/</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">data[</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">title</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">]</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">file</span> <span style="color: #b6a0ff;">in</span> <span style="color: #00bcff;">tqdm</span>(data[<span style="color: #79a8ff;">"files"</span>], <span style="color: #ff9077;">leave</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">False</span>):
            <span style="color: #00d3d0;">filepath</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">projectId</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">/</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">file[</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">path</span><span style="color: #79a8ff; background-color: #000000;">'</span><span style="color: #ffffff; background-color: #000000;">]</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>
            <span style="color: #00bcff;">download_file</span>(filepath, dirpath)

    <span style="color: #b6a0ff;">return</span>


<span style="color: #00d3d0;">projectId</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">"PRJ-3484"</span>
<span style="color: #00bcff;">download_project</span>(projectId)
</pre>
</div>

<p>
This downloads the project files and stores the files in the following structure.
</p>

<div class="org-src-container">
<pre class="src src-bash">tree PRJ-3484
</pre>
</div>

<pre class="example" id="org9e2332c">
PRJ-3484
├── CDSS tests with Sig_v = 100 kPa, Dr = 66.7%, Alpha = 0
│   ├── eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_180_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_190_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_200_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_210_Tau_0_.csv
│   ├── eo_0_600_sigv_100_CSR_0_220_Tau_0_.csv
│   └── eo_0_600_sigv_100_CSR_0_250_Tau_0_.csv
├── CDSS tests with Sig_v = 100 kPa, Dr = 67%, Alpha = 0.3
│   ├── eo_0_601_sigv_100_CSR_0_150_Tau_30_.csv
│   ├── eo_0_601_sigv_100_CSR_0_200_Tau_30_.csv
│   ├── eo_0_601_sigv_100_CSR_0_250_Tau_30_.csv
│   └── eo_0_601_sigv_100_CSR_0_300_Tau_30_.csv
├── CDSS tests with Sig_v = 100 kPa, Dr = 67%, Alpha = 0.4
│   ├── eo_0_601_sigv_100_CSR_0_150_Tau_40_.csv
│   ├── eo_0_601_sigv_100_CSR_0_200_Tau_40_.csv
│   ├── eo_0_601_sigv_100_CSR_0_250_Tau_40_.csv
│   └── eo_0_601_sigv_100_CSR_0_300_Tau_40_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 55.2%, Alpha = 0
│   ├── eo_0_631_sigv_40_CSR_0_100_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_120_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_140_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_150_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_170_Tau_0_.csv
│   ├── eo_0_631_sigv_40_CSR_0_180_Tau_0_.csv
│   └── eo_0_631_sigv_40_CSR_0_190_Tau_0_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 66.2%, Alpha = 0
│   ├── eo_0_601_sigv_40_CSR_0_150_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_170_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_190_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_200_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_210_Tau_0_.csv
│   ├── eo_0_601_sigv_40_CSR_0_220_Tau_0_.csv
│   └── eo_0_601_sigv_40_CSR_0_250_Tau_0_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 66.4%, Alpha = 0.25
│   ├── eo_0_601_sigv_40_CSR_0_200_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_220_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_230_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_240_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_250_Tau_10_.csv
│   ├── eo_0_601_sigv_40_CSR_0_270_Tau_10_.csv
│   └── eo_0_601_sigv_40_CSR_0_300_Tau_10_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 66.4%, Alpha = 0.375
│   ├── eo_0_601_sigv_40_CSR_0_220_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_230_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_250_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_270_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_300_Tau_15_.csv
│   ├── eo_0_601_sigv_40_CSR_0_320_Tau_15_.csv
│   └── eo_0_601_sigv_40_CSR_0_350_Tau_15_.csv
├── CDSS tests with Sig_v = 40 kPa, Dr = 71.2%, Alpha = 0
│   ├── eo_0_588_sigv_40_CSR_0_150_Tau_0_.csv
│   ├── eo_0_588_sigv_40_CSR_0_170_Tau_0_.csv
│   ├── eo_0_588_sigv_40_CSR_0_200_Tau_0_.csv
│   └── eo_0_588_sigv_40_CSR_0_230_Tau_0_.csv
└── CDSS tests with Sig_v = 40 kPa, Dr = 75.5%, Alpha = 0
    ├── eo_0_576_sigv_40_CSR_0_160_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_170_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_190_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_210_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_240_Tau_0_.csv
    ├── eo_0_576_sigv_40_CSR_0_250_Tau_0_.csv
    └── eo_0_576_sigv_40_CSR_0_300_Tau_0_.csv

10 directories, 54 files
</pre>
</div>
</div>
</div>
<div id="outline-container-orge89d1b7" class="outline-2">
<h2 id="orge89d1b7"><span class="section-number-2">6.</span> [DEPRECATED] Generate summary and metadata info for the files</h2>
<div class="outline-text-2" id="text-6">
<p>
UPDATE: See section below for updated function for summary
Next step in building a semantic search engine would be to generate the metadata info/summary for the files inside any project. This can be done using the <kbd>pandas</kbd> library.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> os
<span style="color: #b6a0ff;">import</span> pandas <span style="color: #b6a0ff;">as</span> pd
<span style="color: #b6a0ff;">from</span> pprint <span style="color: #b6a0ff;">import</span> pprint

<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">summarize_csv</span>(<span style="color: #00d3d0;">filepath</span>):
    <span style="color: #79a8ff;">"""</span>
<span style="color: #b0d6f5;">    Summarize a CSV</span>

<span style="color: #b0d6f5;">    This function generates a dictionary that contains the summary</span>
<span style="color: #b0d6f5;">    of the CSV. It also performs some preprocessing on the column</span>
<span style="color: #b0d6f5;">    names by stripping off any whitespace before and after the column</span>
<span style="color: #b0d6f5;">    name and converting the column name to a snake-case. Furthermore,</span>
<span style="color: #b0d6f5;">    it also adds an "increment_&lt;column_name&gt;" key to the summary that</span>
<span style="color: #b0d6f5;">    records the increments used in the first column of the CSV.</span>
<span style="color: #b0d6f5;">    </span><span style="color: #79a8ff;">"""</span>
    <span style="color: #00d3d0;">extension</span> <span style="color: #b6a0ff;">=</span> os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">splitext</span>(filepath)[<span style="color: #00bcff;">1</span>].<span style="color: #00bcff; font-style: italic;">lower</span>()
    <span style="color: #b6a0ff;">if</span> extension <span style="color: #b6a0ff;">==</span> <span style="color: #79a8ff;">".csv"</span>:
        <span style="color: #00d3d0;">df</span> <span style="color: #b6a0ff;">=</span> pd.<span style="color: #00bcff; font-style: italic;">read_csv</span>(filepath)
    <span style="color: #b6a0ff;">elif</span> extension <span style="color: #b6a0ff;">==</span> <span style="color: #79a8ff;">".txt"</span>:
        <span style="color: #00d3d0;">df</span> <span style="color: #b6a0ff;">=</span> pd.<span style="color: #00bcff; font-style: italic;">read_csv</span>(filepath, <span style="color: #ff9077;">engine</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"python"</span>, <span style="color: #ff9077;">sep</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">None</span>)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #b6a0ff;">return</span> <span style="color: #f78fe7;">None</span>, <span style="color: #f78fe7;">dict</span>()
    df.<span style="color: #00d3d0; font-style: italic;">columns</span> <span style="color: #b6a0ff;">=</span> df.<span style="color: #00bcff; font-style: italic;">columns</span>.<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">strip</span>().<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"\s+"</span>, <span style="color: #79a8ff;">" "</span>, <span style="color: #ff9077;">regex</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">True</span>).<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">lower</span>().<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">" "</span>, <span style="color: #79a8ff;">"_"</span>)
    <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> df.<span style="color: #00bcff; font-style: italic;">describe</span>().<span style="color: #00bcff; font-style: italic;">to_dict</span>()
    <span style="color: #00d3d0;">increment</span> <span style="color: #b6a0ff;">=</span> df[df.<span style="color: #00bcff; font-style: italic;">columns</span>[<span style="color: #00bcff;">0</span>]].<span style="color: #00bcff; font-style: italic;">iloc</span>[<span style="color: #00bcff;">2</span>] <span style="color: #b6a0ff;">-</span> df[df.<span style="color: #00bcff; font-style: italic;">columns</span>[<span style="color: #00bcff;">0</span>]].<span style="color: #00bcff; font-style: italic;">iloc</span>[<span style="color: #00bcff;">1</span>]
    summary[<span style="color: #00d3d0;">f"increment_</span><span style="color: #00d3d0;">{</span><span style="color: #00d3d0; background-color: #000000;">df.</span><span style="color: #00d3d0; background-color: #000000; font-style: italic;">columns</span><span style="color: #00d3d0; background-color: #000000;">[</span><span style="color: #00d3d0; background-color: #000000;">0</span><span style="color: #00d3d0; background-color: #000000;">]</span><span style="color: #00d3d0;">}</span><span style="color: #00d3d0;">"</span>] <span style="color: #b6a0ff;">=</span> increment
    <span style="color: #b6a0ff;">return</span> df, summary


<span style="color: #a8a8a8;"># df, summary = summarize_csv("PRJ-3484/CDSS tests with Sig_v = 100 kPa, Dr = 66.7%, Alpha = 0/eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv")</span>
<span style="color: #00d3d0;">df</span>, <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">summarize_csv</span>(<span style="color: #79a8ff;">"PRJ-1783/Cyclic Stress-Controlled Triaxial Tests/eo_0_515_po_100/eo_0_515_po_100_csr_0_3.txt"</span>)
<span style="color: #00bcff;">pprint</span>(summary.<span style="color: #00bcff; font-style: italic;">keys</span>())
</pre>
</div>

<pre class="example">
dict_keys(['time_min', 'eps_a', 'eps_v', 'sigmap_3_kpa', 'sigma_3_kpa', 'sigma_d_kpa', 'increment_time_min'])
</pre>
</div>
</div>
<div id="outline-container-org702b80e" class="outline-2">
<h2 id="org702b80e"><span class="section-number-2">7.</span> Store information in a neo4j database</h2>
<div class="outline-text-2" id="text-7">
<p>
As starting step for creating the graph database, we&rsquo;ll create a structure that would enable the queries of the type
</p>

<blockquote>
<p>
What projects record information regarding shear<sub>strain</sub>?
</p>
</blockquote>
</div>

<div id="outline-container-orgb327795" class="outline-3">
<h3 id="orgb327795"><span class="section-number-3">7.1.</span> Connecting to a Neo4j database</h3>
<div class="outline-text-3" id="text-7-1">
<p>
I&rsquo;ve created a neo4j project locally. I can now use <kbd>py2neo</kbd> to connect to this database.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">from</span> py2neo <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Graph</span>

<span style="color: #00d3d0;">tuitus_db</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Graph</span>(<span style="color: #79a8ff;">"bolt://localhost:7687"</span>, <span style="color: #ff9077;">user</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"neo4j"</span>, <span style="color: #ff9077;">password</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"tuitusci"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org8fef419" class="outline-3">
<h3 id="org8fef419"><span class="section-number-3">7.2.</span> Adding nodes</h3>
<div class="outline-text-3" id="text-7-2">
<p>
To add node for a project, say PRJ-3484, we use the <kbd>Graph.create</kbd> method with the <kbd>Node</kbd> class.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">from</span> py2neo <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Node</span>, <span style="color: #6ae4b9;">Relationship</span>

<span style="color: #00d3d0;">project_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(<span style="color: #79a8ff;">"Project"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"PRJ-3484"</span>)
tuitus_db.<span style="color: #00bcff; font-style: italic;">create</span>(project_node)
</pre>
</div>

<p>
This project will be supervised by a PI, information for which can be found in the project JSON.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #00d3d0;">pi_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(<span style="color: #79a8ff;">"Author"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"mmanzari"</span>)
tuitus_db.<span style="color: #00bcff; font-style: italic;">create</span>(pi_node)
<span style="color: #00d3d0;">pi_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(pi_node, <span style="color: #79a8ff;">"SUPERVISES"</span>, project_node)
tuitus_db.<span style="color: #00bcff; font-style: italic;">create</span>(pi_rel)
</pre>
</div>

<p>
A project can have multiple experiments, each of which can record different information.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #a8a8a8;"># len(tuitus_db.nodes.match("Project", name="PRJ-3484"))</span>

<span style="color: #00d3d0;">project_id</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">"PRJ-3484"</span>
<span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">root</span>, <span style="color: #00d3d0;">dirs</span>, <span style="color: #00d3d0;">files</span> <span style="color: #b6a0ff;">in</span> os.<span style="color: #00bcff; font-style: italic;">walk</span>(project_id):
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">f</span> <span style="color: #b6a0ff;">in</span> files:
        <span style="color: #00d3d0;">_</span>, <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span>
 <span style="color: #00bcff;">summarize_csv</span>(os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">join</span>(root, f))
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">key</span> <span style="color: #b6a0ff;">in</span> summary.<span style="color: #00bcff; font-style: italic;">keys</span>():
            <span style="color: #00d3d0;">matching</span> <span style="color: #b6a0ff;">=</span> tuitus_db.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Data"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>key)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">column_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(<span style="color: #79a8ff;">"Data"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>key)
                tuitus_db.<span style="color: #00bcff; font-style: italic;">create</span>(column_node)
            <span style="color: #b6a0ff;">else</span>:
                <span style="color: #00d3d0;">column_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(matching)[<span style="color: #00bcff;">0</span>]
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(tuitus_db.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(project_node, column_node), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"RECORDS"</span>)) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">col_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(project_node, <span style="color: #79a8ff;">"RECORDS"</span>, column_node)
                tuitus_db.<span style="color: #00bcff; font-style: italic;">create</span>(col_rel)


</pre>
</div>

<p>
I can now combine all these steps into a single function that adds the nodes for a given project with files stored in a directory.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">create_project_data_graph</span>(<span style="color: #00d3d0;">project_id</span>, <span style="color: #00d3d0;">project_path</span>, <span style="color: #00d3d0;">pi</span>, <span style="color: #00d3d0;">graph_db</span>):
    <span style="color: #00d3d0;">project_matching</span> <span style="color: #b6a0ff;">=</span> graph_db.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Project"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>project_id)
    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(project_matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
        <span style="color: #00d3d0;">project_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(<span style="color: #79a8ff;">"Project"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>project_id)
        graph_db.<span style="color: #00bcff; font-style: italic;">create</span>(project_node)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #00d3d0;">project_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(project_matching)[<span style="color: #00bcff;">0</span>]
    <span style="color: #00d3d0;">pi_matching</span> <span style="color: #b6a0ff;">=</span> graph_db.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Author"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>pi)
    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(pi_matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
        <span style="color: #00d3d0;">pi_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(<span style="color: #79a8ff;">"Author"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>pi)
        graph_db.<span style="color: #00bcff; font-style: italic;">create</span>(pi_node)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #00d3d0;">pi_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(pi_matching)[<span style="color: #00bcff;">0</span>]
    <span style="color: #00d3d0;">pi_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(pi_node, <span style="color: #79a8ff;">"SUPERVISES"</span>, project_node)
    graph_db.<span style="color: #00bcff; font-style: italic;">create</span>(pi_rel)

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">root</span>, <span style="color: #00d3d0;">dirs</span>, <span style="color: #00d3d0;">files</span> <span style="color: #b6a0ff;">in</span> os.<span style="color: #00bcff; font-style: italic;">walk</span>(project_id):
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">f</span> <span style="color: #b6a0ff;">in</span> files:
            <span style="color: #00d3d0;">_</span>, <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">summarize_csv</span>(os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">join</span>(root, f))
            <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">key</span> <span style="color: #b6a0ff;">in</span> summary.<span style="color: #00bcff; font-style: italic;">keys</span>():
                <span style="color: #00d3d0;">matching</span> <span style="color: #b6a0ff;">=</span> graph_db.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Data"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>key)
                <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                    <span style="color: #00d3d0;">column_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(<span style="color: #79a8ff;">"Data"</span>, <span style="color: #ff9077;">name</span><span style="color: #b6a0ff;">=</span>key)
                    graph_db.<span style="color: #00bcff; font-style: italic;">create</span>(column_node)
                <span style="color: #b6a0ff;">else</span>:
                    <span style="color: #00d3d0;">column_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(graph_db.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(project_node, column_node), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"RECORDS"</span>)) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                    <span style="color: #00d3d0;">col_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(project_node, <span style="color: #79a8ff;">"RECORDS"</span>, column_node)
                    graph_db.<span style="color: #00bcff; font-style: italic;">create</span>(col_rel)

    <span style="color: #b6a0ff;">return</span>


<span style="color: #a8a8a8;"># create_project_data_graph("PRJ-3484", "./", "mmanzari", tuitus_db)</span>
<span style="color: #a8a8a8;"># create_project_data_graph("PRJ-2137", "./", "mmanzari", tuitus_db)</span>
</pre>
</div>

<p>
This generates a graph db that can now answer the query mentioned above.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">tuitus_db.<span style="color: #00bcff; font-style: italic;">run</span>(<span style="color: #79a8ff;">"MATCH (p:PROJECT)-[:RECORDS]-&gt;(d:Data {name: 'cycle'}) RETURN p, d"</span>)
</pre>
</div>



<figure id="org46df28f">
<img src="../assets/2023-01-30_16-18-10_screenshot.png" alt="2023-01-30_16-18-10_screenshot.png">

</figure>
</div>
</div>
</div>
<div id="outline-container-orga551dce" class="outline-2">
<h2 id="orga551dce"><span class="section-number-2">8.</span> Extract experiment and model config information from the project JSON</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> requests
<span style="color: #b6a0ff;">from</span> pprint <span style="color: #b6a0ff;">import</span> pprint

<span style="color: #00d3d0;">projectId</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">"PRJ-3484"</span>
<span style="color: #00d3d0;">url</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">f"https://designsafe-ci.org/api/projects/publication/</span><span style="color: #b6a0ff;">{</span><span style="color: #ffffff; background-color: #000000;">projectId</span><span style="color: #b6a0ff;">}</span><span style="color: #79a8ff;">"</span>

<span style="color: #00d3d0;">payload</span> <span style="color: #b6a0ff;">=</span> <span style="color: #79a8ff;">""</span>
<span style="color: #00d3d0;">headers</span> <span style="color: #b6a0ff;">=</span> {}

<span style="color: #00d3d0;">response</span> <span style="color: #b6a0ff;">=</span> requests.<span style="color: #00bcff; font-style: italic;">request</span>(<span style="color: #79a8ff;">"GET"</span>, url, <span style="color: #ff9077;">data</span><span style="color: #b6a0ff;">=</span>payload, <span style="color: #ff9077;">headers</span><span style="color: #b6a0ff;">=</span>headers)
<span style="color: #00d3d0;">response_json</span> <span style="color: #b6a0ff;">=</span> response.<span style="color: #00bcff; font-style: italic;">json</span>()
</pre>
</div>

<ul class="org-ul">
<li>The response JSON has 3 top-level lists that are of interest - <kbd>eventsList</kbd>, <kbd>modelConfigs</kbd>, <kbd>experimentsList</kbd>. <kbd>experimentsList</kbd> is a list of all the experiments in the project. Each element of the list contains a <kbd>uuid</kbd> field that is used to link an experiment with a model config or an event. Furthermore, it also has <kbd>["value"]["title"]</kbd> which gives the name of the experiment.</li>
<li>Now, each element in <kbd>eventsList</kbd> and <kbd>modelConfigs</kbd> contains a field <kbd>["value"]["experiments"]</kbd> which is a list of all experiments that the event or the model config is a part of. All of this can be mapped to a project.</li>
<li>Each element in <kbd>eventsList</kbd> also has a <kbd>["value"]["modelConfigs"]</kbd> which is a list of uuids of models that an event is a part of.</li>
</ul>

<p>
With this information, I can now update the <code>create_project_graph</code> function to include everything.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> os
<span style="color: #b6a0ff;">from</span> py2neo <span style="color: #b6a0ff;">import</span> <span style="color: #6ae4b9;">Graph</span>, <span style="color: #6ae4b9;">Node</span>, <span style="color: #6ae4b9;">Relationship</span>

<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">_create_or_return_node</span>(<span style="color: #00d3d0;">node_type</span>, <span style="color: #00d3d0;">node_key</span>, <span style="color: #00d3d0;">graphdb</span>, <span style="color: #b6a0ff;">**</span><span style="color: #00d3d0;">node_props</span>):
    <span style="color: #00d3d0;">matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(node_type, <span style="color: #b6a0ff;">**</span>node_props)
    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
        <span style="color: #00d3d0;">node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(node_type, <span style="color: #b6a0ff;">**</span>node_props)
        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(node)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #00d3d0;">node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(matching)[<span style="color: #00bcff;">0</span>]
    <span style="color: #b6a0ff;">return</span> node

<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">create_project_graph</span>(<span style="color: #00d3d0;">project_info</span>, <span style="color: #00d3d0;">project_path</span>, <span style="color: #00d3d0;">graphdb</span>):
    <span style="color: #00d3d0;">project_id</span> <span style="color: #b6a0ff;">=</span> project_info.<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">"project_id"</span>, <span style="color: #f78fe7;">None</span>)
    <span style="color: #b6a0ff;">if</span> project_id <span style="color: #b6a0ff;">is</span> <span style="color: #f78fe7;">None</span>:
        <span style="color: #00d3d0;">project_id</span> <span style="color: #b6a0ff;">=</span> project_info.<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">"projectId"</span>, <span style="color: #f78fe7;">None</span>)
    <span style="color: #b6a0ff;">if</span> project_id <span style="color: #b6a0ff;">is</span> <span style="color: #f78fe7;">None</span>:
        <span style="color: #b6a0ff;">raise</span> <span style="color: #6ae4b9;">KeyError</span>(<span style="color: #79a8ff;">"project_id or projectId not found in project info."</span>)

    <span style="color: #00d3d0;">project_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: project_id}
    <span style="color: #00d3d0;">project_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
        <span style="color: #79a8ff;">"Project"</span>, {<span style="color: #79a8ff;">"name"</span>: project_id}, graphdb, <span style="color: #b6a0ff;">**</span>project_props
    )

    <span style="color: #00d3d0;">pi</span> <span style="color: #b6a0ff;">=</span> project_info[<span style="color: #79a8ff;">"project"</span>][<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"pi"</span>]
    <span style="color: #00d3d0;">pi_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: pi}
    <span style="color: #00d3d0;">pi_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
        <span style="color: #79a8ff;">"Author"</span>, {<span style="color: #79a8ff;">"name"</span>: pi}, graphdb, <span style="color: #b6a0ff;">**</span>pi_props
    )
    <span style="color: #00d3d0;">pi_project_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(pi_node, <span style="color: #79a8ff;">"SUPERVISES"</span>, project_node)
    graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(pi_project_rel)

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">exp</span> <span style="color: #b6a0ff;">in</span> project_info[<span style="color: #79a8ff;">"experimentsList"</span>]:
        <span style="color: #00d3d0;">experiment_props</span> <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"uuid"</span>: exp[<span style="color: #79a8ff;">"uuid"</span>],
            <span style="color: #79a8ff;">"title"</span>: exp[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        }
        <span style="color: #00d3d0;">exp_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
            <span style="color: #79a8ff;">"Experiment"</span>, {<span style="color: #79a8ff;">"uuid"</span>: exp[<span style="color: #79a8ff;">"uuid"</span>]}, graphdb, <span style="color: #b6a0ff;">**</span>experiment_props
        )
        <span style="color: #00d3d0;">exp_project_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(project_node, <span style="color: #79a8ff;">"HAS_EXPERIMENT"</span>, exp_node)
        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(exp_project_rel)

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">model</span> <span style="color: #b6a0ff;">in</span> project_info[<span style="color: #79a8ff;">"modelConfigs"</span>]:
        <span style="color: #00d3d0;">model_props</span> <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"uuid"</span>: model[<span style="color: #79a8ff;">"uuid"</span>],
            <span style="color: #79a8ff;">"title"</span>: model[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        }
        <span style="color: #00d3d0;">model_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
            <span style="color: #79a8ff;">"Model"</span>, {<span style="color: #79a8ff;">"uuid"</span>: model[<span style="color: #79a8ff;">"uuid"</span>]}, graphdb, <span style="color: #b6a0ff;">**</span>model_props
        )
        <span style="color: #00d3d0;">model_exps</span> <span style="color: #b6a0ff;">=</span> model[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"experiments"</span>]
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">exp_uuid</span> <span style="color: #b6a0ff;">in</span> model_exps:
            <span style="color: #00d3d0;">exp_matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Experiment"</span>, <span style="color: #ff9077;">uuid</span><span style="color: #b6a0ff;">=</span>exp_uuid)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(exp_matching) <span style="color: #b6a0ff;">&gt;</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">exp_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(exp_matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #00d3d0;">model_experiment_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(exp_node, <span style="color: #79a8ff;">"HAS_MODEL"</span>, model_node)
                graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(model_experiment_rel)

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">event</span> <span style="color: #b6a0ff;">in</span> project_info[<span style="color: #79a8ff;">"eventsList"</span>]:
        <span style="color: #00d3d0;">event_props</span> <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"title"</span>: event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        }
        <span style="color: #00d3d0;">event_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(

            <span style="color: #79a8ff;">"Event"</span>, {<span style="color: #79a8ff;">"title"</span>: event_props[<span style="color: #79a8ff;">"title"</span>]}, graphdb, <span style="color: #b6a0ff;">**</span>event_props
        )
        <span style="color: #00d3d0;">event_exps</span> <span style="color: #b6a0ff;">=</span> event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"experiments"</span>]
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">exp_uuid</span> <span style="color: #b6a0ff;">in</span> event_exps:
            <span style="color: #00d3d0;">exp_matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Experiment"</span>, <span style="color: #ff9077;">uuid</span><span style="color: #b6a0ff;">=</span>exp_uuid)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(exp_matching) <span style="color: #b6a0ff;">&gt;</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">exp_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(exp_matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #00d3d0;">event_experiment_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(exp_node, <span style="color: #79a8ff;">"HAS_EVENT"</span>, event_node)
                graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(event_experiment_rel)

        <span style="color: #00d3d0;">event_models</span> <span style="color: #b6a0ff;">=</span> event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"modelConfigs"</span>]
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">model_uuid</span> <span style="color: #b6a0ff;">in</span> event_models:
            <span style="color: #00d3d0;">model_matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Model"</span>, <span style="color: #ff9077;">uuid</span><span style="color: #b6a0ff;">=</span>model_uuid)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(model_matching) <span style="color: #b6a0ff;">&gt;</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">model_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(model_matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #00d3d0;">event_model_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(model_node, <span style="color: #79a8ff;">"HAS_EVENT"</span>, event_node)
                graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(event_model_rel)

        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">root</span>, <span style="color: #00d3d0;">dirs</span>, <span style="color: #00d3d0;">files</span> <span style="color: #b6a0ff;">in</span> os.<span style="color: #00bcff; font-style: italic;">walk</span>(
                os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">join</span>(project_path, project_id, event_props[<span style="color: #79a8ff;">"title"</span>])
        ):
            <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">f</span> <span style="color: #b6a0ff;">in</span> files:
                <span style="color: #00d3d0;">filepath</span> <span style="color: #b6a0ff;">=</span> os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">join</span>(root, f)
                <span style="color: #00d3d0;">file_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(<span style="color: #79a8ff;">"File"</span>, {<span style="color: #79a8ff;">"filepath"</span>: filepath}, graphdb, <span style="color: #b6a0ff;">**</span>{<span style="color: #79a8ff;">"filepath"</span>: filepath})
                <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(graphdb.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(event_node, file_node), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"HAS_FILE"</span>)) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                    <span style="color: #00d3d0;">event_file_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(event_node, <span style="color: #79a8ff;">"HAS_FILE"</span>, file_node)
                    graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(event_file_rel)
                <span style="color: #00d3d0;">_</span>, <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">summarize_csv</span>(filepath)
                <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">key</span>, <span style="color: #00d3d0;">props</span> <span style="color: #b6a0ff;">in</span> summary.<span style="color: #00bcff; font-style: italic;">items</span>():
                    <span style="color: #b6a0ff;">if</span> <span style="color: #b6a0ff;">not</span> <span style="color: #f78fe7;">isinstance</span>(props, dict):
                        <span style="color: #00d3d0;">props</span> <span style="color: #b6a0ff;">=</span> {key: props}
                    <span style="color: #00d3d0;">col_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: key, <span style="color: #b6a0ff;">**</span>props}
                    <span style="color: #00d3d0;">column_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
                        <span style="color: #79a8ff;">"Data"</span>, {<span style="color: #79a8ff;">"name"</span>: key}, graphdb, <span style="color: #b6a0ff;">**</span>col_props
                    )
                    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(graphdb.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(project_node, column_node), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"RECORDS"</span>)) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                        <span style="color: #00d3d0;">col_proj_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(project_node, <span style="color: #79a8ff;">"RECORDS"</span>, column_node)
                        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(col_proj_rel)
                    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(graphdb.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(event_node, column_node), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"RECORDS"</span>)) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                        <span style="color: #00d3d0;">col_event_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(event_node, <span style="color: #79a8ff;">"RECORDS"</span>, column_node)
                        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(col_event_rel)
                    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(graphdb.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(file_node, column_node), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"RECORDS"</span>)) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
                        <span style="color: #00d3d0;">col_file_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(file_node, <span style="color: #79a8ff;">"RECORDS"</span>, column_node)
                        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(col_file_rel)
    <span style="color: #b6a0ff;">return</span>

<span style="color: #00bcff;">create_project_graph</span>(response_json, <span style="color: #79a8ff;">"./"</span>, tuitus_db)
</pre>
</div>

<p>
With this, we now have a much dense graph with relationships that can be queried.
</p>


<figure id="orgb639f2d">
<img src="../assets/Extract_experiment_and_model_config_information_from_the_project_JSON/2023-02-01_13-26-07_screenshot.png" alt="2023-02-01_13-26-07_screenshot.png" width="60%">

</figure>

<p>
Example query:
</p>

<blockquote>
<p>
List all the projects, experiments, models and events that record &ldquo;axial<sub>stress</sub>&rdquo;.
</p>
</blockquote>


<figure id="orga421fd2">
<img src="../assets/Extract_experiment_and_model_config_information_from_the_project_JSON/2023-02-01_13-34-40_screenshot.png" alt="2023-02-01_13-34-40_screenshot.png" width="60%">

</figure>
</div>
</div>
<div id="outline-container-orgb99b2ed" class="outline-2">
<h2 id="orgb99b2ed"><span class="section-number-2">9.</span> Update <code>summarize_csv</code> to include categorical variables and round decimals</h2>
<div class="outline-text-2" id="text-9">
<p>
The current <code>summarize_csv</code> doesn&rsquo;t include categorical columns in the summary. This means that if there were a column without numeric values, it would not be present in the summary. Columns can be included by passing the <code>include="all"</code> parameter to the <code>.describe()</code> function. Though, this introduces another issue as now there are multiple NaN values in the summary depending on the type of column. This information is unnecessary for the database node properties and should be removed. It also rounds off all the summary statistics to upto 5 decimal places so that the values are tractable in the database search. The new function takes care of all of this.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">import</span> os
<span style="color: #b6a0ff;">import</span> pandas <span style="color: #b6a0ff;">as</span> pd
<span style="color: #b6a0ff;">from</span> pprint <span style="color: #b6a0ff;">import</span> pprint

<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">summarize_csv</span>(<span style="color: #00d3d0;">filepath</span>):
    <span style="color: #79a8ff;">"""</span>
<span style="color: #b0d6f5;">    Summarize a CSV</span>

<span style="color: #b0d6f5;">    This function generates a dictionary that contains the summary</span>
<span style="color: #b0d6f5;">    of the CSV. It also performs some preprocessing on the column</span>
<span style="color: #b0d6f5;">    names by stripping off any whitespace before and after the column</span>
<span style="color: #b0d6f5;">    name and converting the column name to a snake-case. Furthermore,</span>
<span style="color: #b0d6f5;">    it also adds an "increment_&lt;column_name&gt;" key to the summary that</span>
<span style="color: #b0d6f5;">    records the increments used in the first column of the CSV.</span>
<span style="color: #b0d6f5;">    </span><span style="color: #79a8ff;">"""</span>
    <span style="color: #00d3d0;">extension</span> <span style="color: #b6a0ff;">=</span> os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">splitext</span>(filepath)[<span style="color: #00bcff;">1</span>].<span style="color: #00bcff; font-style: italic;">lower</span>()
    <span style="color: #b6a0ff;">if</span> extension <span style="color: #b6a0ff;">==</span> <span style="color: #79a8ff;">".csv"</span>:
        <span style="color: #00d3d0;">df</span> <span style="color: #b6a0ff;">=</span> pd.<span style="color: #00bcff; font-style: italic;">read_csv</span>(filepath)
    <span style="color: #b6a0ff;">elif</span> extension <span style="color: #b6a0ff;">==</span> <span style="color: #79a8ff;">".txt"</span>:
        <span style="color: #00d3d0;">df</span> <span style="color: #b6a0ff;">=</span> pd.<span style="color: #00bcff; font-style: italic;">read_csv</span>(filepath, <span style="color: #ff9077;">engine</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"python"</span>, <span style="color: #ff9077;">sep</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">None</span>)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #b6a0ff;">return</span> <span style="color: #f78fe7;">None</span>, <span style="color: #f78fe7;">dict</span>()
    df.<span style="color: #00d3d0; font-style: italic;">columns</span> <span style="color: #b6a0ff;">=</span> df.<span style="color: #00bcff; font-style: italic;">columns</span>.<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">strip</span>().<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">replace</span>(<span style="color: #79a8ff;">"\s+"</span>, <span style="color: #79a8ff;">""</span>, <span style="color: #ff9077;">regex</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">True</span>).<span style="color: #00bcff; font-style: italic;">str</span>.<span style="color: #00bcff; font-style: italic;">lower</span>()
    <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> df.<span style="color: #00bcff; font-style: italic;">describe</span>(<span style="color: #ff9077;">include</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"all"</span>).<span style="color: #00bcff; font-style: italic;">round</span>(<span style="color: #00bcff;">2</span>).<span style="color: #00bcff; font-style: italic;">to_dict</span>()
    <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> {
        colname: colsummary <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">colname</span>, <span style="color: #00d3d0;">colsummary</span> <span style="color: #b6a0ff;">in</span> summary.<span style="color: #00bcff; font-style: italic;">items</span>() <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">k</span>, <span style="color: #00d3d0;">v</span> <span style="color: #b6a0ff;">in</span> colsummary.<span style="color: #00bcff; font-style: italic;">items</span>() <span style="color: #b6a0ff;">if</span> <span style="color: #b6a0ff;">not</span> pd.<span style="color: #00bcff; font-style: italic;">isna</span>(v)
    }
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">colname</span>, <span style="color: #00d3d0;">colsummary</span> <span style="color: #b6a0ff;">in</span> summary.<span style="color: #00bcff; font-style: italic;">items</span>():
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">k</span>, <span style="color: #00d3d0;">v</span> <span style="color: #b6a0ff;">in</span> colsummary.<span style="color: #00bcff; font-style: italic;">items</span>():
            <span style="color: #b6a0ff;">try</span>:
                colsummary[<span style="color: #00d3d0;">k</span>] <span style="color: #b6a0ff;">=</span> v.<span style="color: #00bcff; font-style: italic;">item</span>()
            <span style="color: #b6a0ff;">except</span> <span style="color: #6ae4b9;">AttributeError</span>:
                <span style="color: #b6a0ff;">pass</span>
    <span style="color: #00d3d0;">increment</span> <span style="color: #b6a0ff;">=</span> (df[df.<span style="color: #00bcff; font-style: italic;">columns</span>[<span style="color: #00bcff;">0</span>]].<span style="color: #00bcff; font-style: italic;">iloc</span>[<span style="color: #00bcff;">2</span>] <span style="color: #b6a0ff;">-</span> df[df.<span style="color: #00bcff; font-style: italic;">columns</span>[<span style="color: #00bcff;">0</span>]].<span style="color: #00bcff; font-style: italic;">iloc</span>[<span style="color: #00bcff;">1</span>]).<span style="color: #00bcff; font-style: italic;">round</span>(<span style="color: #00bcff;">5</span>).<span style="color: #00bcff; font-style: italic;">item</span>()
    summary[<span style="color: #00d3d0;">f"increment_</span><span style="color: #00d3d0;">{</span><span style="color: #00d3d0; background-color: #000000;">df.</span><span style="color: #00d3d0; background-color: #000000; font-style: italic;">columns</span><span style="color: #00d3d0; background-color: #000000;">[</span><span style="color: #00d3d0; background-color: #000000;">0</span><span style="color: #00d3d0; background-color: #000000;">]</span><span style="color: #00d3d0;">}</span><span style="color: #00d3d0;">"</span>] <span style="color: #b6a0ff;">=</span> increment
    <span style="color: #b6a0ff;">return</span> df, summary


<span style="color: #a8a8a8;"># df, summary = summarize_csv("PRJ-3484/CDSS tests with Sig_v = 100 kPa, Dr = 66.7%, Alpha = 0/eo_0_600_sigv_100_CSR_0_170_Tau_0_.csv")</span>
<span style="color: #00d3d0;">df</span>, <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">summarize_csv</span>(<span style="color: #79a8ff;">"PRJ-1783/Cyclic Stress-Controlled Triaxial Tests/eo_0_515_po_100/eo_0_515_po_100_csr_0_3.txt"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0522026" class="outline-2">
<h2 id="org0522026"><span class="section-number-2">10.</span> Querying database using <kbd>py2neo</kbd></h2>
<div class="outline-text-2" id="text-10">
<p>
With the new properties related to the summaries in the nodes, we can now query them to get information filtered on the values from the summary. For example, there are a total of 3 <kbd>Data</kbd> nodes in the graph with means 20.5, 30.5, 38.06454 respectively. We can now query for all the Nodes which have a mean higher than 30.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">tuitus_db.<span style="color: #00bcff; font-style: italic;">run</span>(<span style="color: #79a8ff;">"MATCH (d:Data {name: 'normal_stress'}) RETURN d"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python">tuitus_db.<span style="color: #00bcff; font-style: italic;">run</span>(<span style="color: #79a8ff;">"MATCH (d:Data {name: 'normal_stress'}) WHERE d.mean &gt; 30 RETURN d"</span>)
</pre>
</div>

<pre class="example">
 d                                                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 (_5:Data {`25%`: 24.30745, `50%`: 33.5288, `75%`: 50.4053, count: 1407.0, max: 99.5891, mean: 38.06454, min: 1.99448, name: 'normal_stress', std: 19.35634})
</pre>
</div>
</div>
<div id="outline-container-org82b3beb" class="outline-2">
<h2 id="org82b3beb"><span class="section-number-2">11.</span> Modify project creation to support file path from response JSON</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">_create_or_return_node</span>(<span style="color: #00d3d0;">node_type</span>, <span style="color: #00d3d0;">node_key</span>, <span style="color: #00d3d0;">graphdb</span>, <span style="color: #b6a0ff;">**</span><span style="color: #00d3d0;">node_props</span>):
    <span style="color: #00d3d0;">matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(node_type, <span style="color: #b6a0ff;">**</span>node_props)
    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
        <span style="color: #00d3d0;">node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Node</span>(node_type, <span style="color: #b6a0ff;">**</span>node_props)
        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(node)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #00d3d0;">node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(matching)[<span style="color: #00bcff;">0</span>]
    <span style="color: #b6a0ff;">return</span> node


<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">_create_or_return_rel</span>(<span style="color: #00d3d0;">node1</span>, <span style="color: #00d3d0;">node2</span>, <span style="color: #00d3d0;">r_type</span>, <span style="color: #00d3d0;">graphdb</span>):
    <span style="color: #00d3d0;">matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">relationships</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #ff9077;">nodes</span><span style="color: #b6a0ff;">=</span>(node1, node2), <span style="color: #ff9077;">r_type</span><span style="color: #b6a0ff;">=</span>r_type)
    <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(matching) <span style="color: #b6a0ff;">==</span> <span style="color: #00bcff;">0</span>:
        <span style="color: #00d3d0;">rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(node1, r_type, node2)
        graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(rel)
    <span style="color: #b6a0ff;">else</span>:
        <span style="color: #00d3d0;">rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(matching)[<span style="color: #00bcff;">0</span>]
    <span style="color: #b6a0ff;">return</span> rel


<span style="color: #b6a0ff;">def</span> <span style="color: #feacd0;">create_project_graph</span>(<span style="color: #00d3d0;">project_info</span>, <span style="color: #00d3d0;">project_path</span>, <span style="color: #00d3d0;">graphdb</span>):
    <span style="color: #00d3d0;">project_id</span> <span style="color: #b6a0ff;">=</span> project_info.<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">"project_id"</span>, <span style="color: #f78fe7;">None</span>)
    <span style="color: #b6a0ff;">if</span> project_id <span style="color: #b6a0ff;">is</span> <span style="color: #f78fe7;">None</span>:
        <span style="color: #00d3d0;">project_id</span> <span style="color: #b6a0ff;">=</span> project_info.<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">"projectId"</span>, <span style="color: #f78fe7;">None</span>)
    <span style="color: #b6a0ff;">if</span> project_id <span style="color: #b6a0ff;">is</span> <span style="color: #f78fe7;">None</span>:
        <span style="color: #b6a0ff;">raise</span> <span style="color: #6ae4b9;">KeyError</span>(<span style="color: #79a8ff;">"project_id or projectId not found in project info."</span>)

    <span style="color: #00d3d0;">project_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: project_id}
    <span style="color: #00d3d0;">project_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
        <span style="color: #79a8ff;">"Project"</span>, {<span style="color: #79a8ff;">"name"</span>: project_id}, graphdb, <span style="color: #b6a0ff;">**</span>project_props
    )

    <span style="color: #00d3d0;">pi</span> <span style="color: #b6a0ff;">=</span> project_info[<span style="color: #79a8ff;">"project"</span>][<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"pi"</span>]
    <span style="color: #00d3d0;">pi_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: pi}
    <span style="color: #00d3d0;">pi_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
        <span style="color: #79a8ff;">"Author"</span>, {<span style="color: #79a8ff;">"name"</span>: pi}, graphdb, <span style="color: #b6a0ff;">**</span>pi_props
    )
    <span style="color: #00d3d0;">pi_project_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(pi_node, <span style="color: #79a8ff;">"SUPERVISES"</span>, project_node)
    graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(pi_project_rel)

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">nh</span> <span style="color: #b6a0ff;">in</span> project_info[<span style="color: #79a8ff;">"project"</span>][<span style="color: #79a8ff;">"value"</span>].<span style="color: #00bcff; font-style: italic;">get</span>(<span style="color: #79a8ff;">"nhTypes"</span>, []):
        <span style="color: #00d3d0;">nh_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: nh}
        <span style="color: #00d3d0;">nh_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
            <span style="color: #79a8ff;">"Hazard"</span>, nh_props, graphdb, <span style="color: #b6a0ff;">**</span>nh_props
        )
        <span style="color: #00bcff;">_create_or_return_rel</span>(project_node, nh_node, <span style="color: #79a8ff;">"NATURAL_HAZARD"</span>, graphdb)

    <span style="color: #00d3d0;">project_type</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
        <span style="color: #79a8ff;">"PROJECT_TYPE"</span>,
        {<span style="color: #79a8ff;">"name"</span>: <span style="color: #79a8ff;">"experimental"</span>},
        graphdb,
        <span style="color: #b6a0ff;">**</span>{<span style="color: #79a8ff;">"name"</span>: <span style="color: #79a8ff;">"experimental"</span>},
    )
    <span style="color: #00bcff;">_create_or_return_rel</span>(project_node, project_type, <span style="color: #79a8ff;">"TYPE"</span>, graphdb)
    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">exp</span> <span style="color: #b6a0ff;">in</span> <span style="color: #00bcff;">tqdm</span>(
        project_info[<span style="color: #79a8ff;">"experimentsList"</span>], <span style="color: #ff9077;">desc</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"Experiment"</span>, <span style="color: #ff9077;">leave</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">False</span>
    ):
        <span style="color: #00d3d0;">experiment_props</span> <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"uuid"</span>: exp[<span style="color: #79a8ff;">"uuid"</span>],
            <span style="color: #79a8ff;">"title"</span>: exp[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        }
        <span style="color: #00d3d0;">exp_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
            <span style="color: #79a8ff;">"Experiment"</span>, {<span style="color: #79a8ff;">"uuid"</span>: exp[<span style="color: #79a8ff;">"uuid"</span>]}, graphdb, <span style="color: #b6a0ff;">**</span>experiment_props
        )
        <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
            project_node, exp_node, <span style="color: #79a8ff;">"HAS_EXPERIMENT"</span>, graphdb
        )

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">model</span> <span style="color: #b6a0ff;">in</span> <span style="color: #00bcff;">tqdm</span>(project_info[<span style="color: #79a8ff;">"modelConfigs"</span>], <span style="color: #ff9077;">desc</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"Model"</span>, <span style="color: #ff9077;">leave</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">False</span>):
        <span style="color: #00d3d0;">model_props</span> <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"uuid"</span>: model[<span style="color: #79a8ff;">"uuid"</span>],
            <span style="color: #79a8ff;">"title"</span>: model[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        }
        <span style="color: #00d3d0;">model_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
            <span style="color: #79a8ff;">"Model"</span>, {<span style="color: #79a8ff;">"uuid"</span>: model[<span style="color: #79a8ff;">"uuid"</span>]}, graphdb, <span style="color: #b6a0ff;">**</span>model_props
        )
        <span style="color: #00d3d0;">model_exps</span> <span style="color: #b6a0ff;">=</span> model[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"experiments"</span>]
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">exp_uuid</span> <span style="color: #b6a0ff;">in</span> model_exps:
            <span style="color: #00d3d0;">exp_matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Experiment"</span>, <span style="color: #ff9077;">uuid</span><span style="color: #b6a0ff;">=</span>exp_uuid)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(exp_matching) <span style="color: #b6a0ff;">&gt;</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">exp_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(exp_matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
                    exp_node, model_node, <span style="color: #79a8ff;">"HAS_MODEL"</span>, graphdb
                )

    <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">event</span> <span style="color: #b6a0ff;">in</span> <span style="color: #00bcff;">tqdm</span>(project_info[<span style="color: #79a8ff;">"eventsList"</span>], <span style="color: #ff9077;">desc</span><span style="color: #b6a0ff;">=</span><span style="color: #79a8ff;">"Events"</span>, <span style="color: #ff9077;">leave</span><span style="color: #b6a0ff;">=</span><span style="color: #f78fe7;">False</span>):
        <span style="color: #00d3d0;">event_props</span> <span style="color: #b6a0ff;">=</span> {
            <span style="color: #79a8ff;">"title"</span>: event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"title"</span>],
        }
        <span style="color: #00d3d0;">event_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
            <span style="color: #79a8ff;">"Event"</span>, {<span style="color: #79a8ff;">"title"</span>: event_props[<span style="color: #79a8ff;">"title"</span>]}, graphdb, <span style="color: #b6a0ff;">**</span>event_props
        )
        <span style="color: #00d3d0;">event_exps</span> <span style="color: #b6a0ff;">=</span> event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"experiments"</span>]
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">exp_uuid</span> <span style="color: #b6a0ff;">in</span> event_exps:
            <span style="color: #00d3d0;">exp_matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Experiment"</span>, <span style="color: #ff9077;">uuid</span><span style="color: #b6a0ff;">=</span>exp_uuid)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(exp_matching) <span style="color: #b6a0ff;">&gt;</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">exp_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(exp_matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
                    exp_node, event_node, <span style="color: #79a8ff;">"HAS_EVENT"</span>, graphdb
                )

        <span style="color: #00d3d0;">event_models</span> <span style="color: #b6a0ff;">=</span> event[<span style="color: #79a8ff;">"value"</span>][<span style="color: #79a8ff;">"modelConfigs"</span>]
        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">model_uuid</span> <span style="color: #b6a0ff;">in</span> event_models:
            <span style="color: #00d3d0;">model_matching</span> <span style="color: #b6a0ff;">=</span> graphdb.<span style="color: #00bcff; font-style: italic;">nodes</span>.<span style="color: #00bcff; font-style: italic;">match</span>(<span style="color: #79a8ff;">"Model"</span>, <span style="color: #ff9077;">uuid</span><span style="color: #b6a0ff;">=</span>model_uuid)
            <span style="color: #b6a0ff;">if</span> <span style="color: #f78fe7;">len</span>(model_matching) <span style="color: #b6a0ff;">&gt;</span> <span style="color: #00bcff;">0</span>:
                <span style="color: #00d3d0;">model_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #f78fe7;">list</span>(model_matching)[<span style="color: #00bcff;">0</span>]
                <span style="color: #00d3d0;">event_model_rel</span> <span style="color: #b6a0ff;">=</span> <span style="color: #6ae4b9;">Relationship</span>(
                    model_node, <span style="color: #79a8ff;">"HAS_EVENT"</span>, event_node
                )
                graphdb.<span style="color: #00bcff; font-style: italic;">create</span>(event_model_rel)
                <span style="color: #00bcff;">_create_or_return_rel</span>(
                    model_node, event_node, <span style="color: #79a8ff;">"HAS_EVENT"</span>, graphdb
                )

        <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">fdict</span> <span style="color: #b6a0ff;">in</span> event[<span style="color: #79a8ff;">"fileObjs"</span>]:
            <span style="color: #00d3d0;">f</span> <span style="color: #b6a0ff;">=</span> fdict[<span style="color: #79a8ff;">"path"</span>][<span style="color: #00bcff;">1</span>:]
            <span style="color: #a8a8a8;"># extension = os.path.splitext(f)[1].lower()</span>
            <span style="color: #a8a8a8;"># if extension not in {".txt", ".csv"}:</span>
            <span style="color: #a8a8a8;">#     continue</span>
            <span style="color: #00d3d0;">filepath</span> <span style="color: #b6a0ff;">=</span> os.<span style="color: #00bcff; font-style: italic;">path</span>.<span style="color: #00bcff; font-style: italic;">join</span>(project_path, project_id, f)
            <span style="color: #00d3d0;">file_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
                <span style="color: #79a8ff;">"File"</span>,
                {<span style="color: #79a8ff;">"filepath"</span>: filepath},
                graphdb,
                <span style="color: #b6a0ff;">**</span>{<span style="color: #79a8ff;">"filepath"</span>: filepath},
            )
            <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
                event_node, file_node, <span style="color: #79a8ff;">"HAS_FILE"</span>, graphdb
            )
            <span style="color: #00d3d0;">_</span>, <span style="color: #00d3d0;">summary</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">summarize_csv</span>(filepath)
            <span style="color: #b6a0ff;">for</span> <span style="color: #00d3d0;">key</span>, <span style="color: #00d3d0;">props</span> <span style="color: #b6a0ff;">in</span> summary.<span style="color: #00bcff; font-style: italic;">items</span>():
                <span style="color: #b6a0ff;">if</span> <span style="color: #b6a0ff;">not</span> <span style="color: #f78fe7;">isinstance</span>(props, dict):
                    <span style="color: #00d3d0;">props</span> <span style="color: #b6a0ff;">=</span> {key: props}
                <span style="color: #00d3d0;">col_props</span> <span style="color: #b6a0ff;">=</span> {<span style="color: #79a8ff;">"name"</span>: key, <span style="color: #b6a0ff;">**</span>props}
                <span style="color: #00d3d0;">column_node</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_node</span>(
                    <span style="color: #79a8ff;">"Data"</span>, {<span style="color: #79a8ff;">"name"</span>: key}, graphdb, <span style="color: #b6a0ff;">**</span>col_props
                )
                <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
                    project_node, column_node, <span style="color: #79a8ff;">"RECORDS"</span>, graphdb
                )
                <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
                    event_node, column_node, <span style="color: #79a8ff;">"RECORDS"</span>, graphdb
                )
                <span style="color: #00d3d0;">_</span> <span style="color: #b6a0ff;">=</span> <span style="color: #00bcff;">_create_or_return_rel</span>(
                    file_node, column_node, <span style="color: #79a8ff;">"RECORDS"</span>, graphdb
                )
    <span style="color: #b6a0ff;">return</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/>
<footer>
<div class="generated">
Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.6.1)
</div>
</footer>
</div>
</body>
</html>